<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Inherited,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>The AEGIS Family of Authenticated Encryption Algorithms</title>
<meta content="Frank Denis" name="author">
<meta content="Samuel Lucas" name="author">
<meta content="
       This document describes the AEGIS-128L, AEGIS-256, AEGIS-128X, and AEGIS-256X AES-based authenticated encryption algorithms designed for high-performance applications. 
       The document is a product of the Crypto Forum Research Group (CFRG). It is not an IETF product and is not a standard. 
    " name="description">
<meta content="xml2rfc 3.25.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-irtf-cfrg-aegis-aead-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.25.0
    Python 3.12.7
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 5.3.0
    platformdirs 4.3.6
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-irtf-cfrg-aegis-aead.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">The AEGIS Family of Authenticated Encryp</td>
<td class="right">December 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Denis &amp; Lucas</td>
<td class="center">Expires 12 June 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Crypto Forum</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-irtf-cfrg-aegis-aead-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-12-09" class="published">9 December 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-06-12">12 June 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">F. Denis</div>
<div class="org">Fastly Inc.</div>
</div>
<div class="author">
      <div class="author-name">S. Lucas</div>
<div class="org">Individual Contributor</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">The AEGIS Family of Authenticated Encryption Algorithms</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes the AEGIS-128L, AEGIS-256, AEGIS-128X, and AEGIS-256X AES-based authenticated encryption algorithms designed for high-performance applications.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">The document is a product of the Crypto Forum Research Group (CFRG). It is not an IETF product and is not a standard.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Source for this draft and an issue tracker can be found at
    <span><a href="https://github.com/cfrg/draft-irtf-cfrg-aegis-aead">https://github.com/cfrg/draft-irtf-cfrg-aegis-aead</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 12 June 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-the-aegis-128l-algorithm" class="internal xref">The AEGIS-128L Algorithm</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-authenticated-encryption" class="internal xref">Authenticated Encryption</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-authenticated-decryption" class="internal xref">Authenticated Decryption</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-the-init-function" class="internal xref">The Init Function</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-the-update-function" class="internal xref">The Update Function</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-the-absorb-function" class="internal xref">The Absorb Function</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="auto internal xref">3.6</a>.  <a href="#name-the-enc-function" class="internal xref">The Enc Function</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="auto internal xref">3.7</a>.  <a href="#name-the-dec-function" class="internal xref">The Dec Function</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.8">
                <p id="section-toc.1-1.3.2.8.1"><a href="#section-3.8" class="auto internal xref">3.8</a>.  <a href="#name-the-decpartial-function" class="internal xref">The DecPartial Function</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.9">
                <p id="section-toc.1-1.3.2.9.1"><a href="#section-3.9" class="auto internal xref">3.9</a>.  <a href="#name-the-finalize-function" class="internal xref">The Finalize Function</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-the-aegis-256-algorithm" class="internal xref">The AEGIS-256 Algorithm</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-authenticated-encryption-2" class="internal xref">Authenticated Encryption</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-authenticated-decryption-2" class="internal xref">Authenticated Decryption</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-the-init-function-2" class="internal xref">The Init Function</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-the-update-function-2" class="internal xref">The Update Function</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-the-absorb-function-2" class="internal xref">The Absorb Function</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="auto internal xref">4.6</a>.  <a href="#name-the-enc-function-2" class="internal xref">The Enc Function</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.7">
                <p id="section-toc.1-1.4.2.7.1"><a href="#section-4.7" class="auto internal xref">4.7</a>.  <a href="#name-the-dec-function-2" class="internal xref">The Dec Function</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8">
                <p id="section-toc.1-1.4.2.8.1"><a href="#section-4.8" class="auto internal xref">4.8</a>.  <a href="#name-the-decpartial-function-2" class="internal xref">The DecPartial Function</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.9">
                <p id="section-toc.1-1.4.2.9.1"><a href="#section-4.9" class="auto internal xref">4.9</a>.  <a href="#name-the-finalize-function-2" class="internal xref">The Finalize Function</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-parallel-modes" class="internal xref">Parallel Modes</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-additional-conventions-and-" class="internal xref">Additional Conventions and Definitions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-authenticated-encryption-3" class="internal xref">Authenticated Encryption</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-authenticated-decryption-3" class="internal xref">Authenticated Decryption</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-aegis-128x" class="internal xref">AEGIS-128X</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.1">
                    <p id="section-toc.1-1.5.2.4.2.1.1"><a href="#section-5.4.1" class="auto internal xref">5.4.1</a>.  <a href="#name-the-init-function-3" class="internal xref">The Init Function</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.2">
                    <p id="section-toc.1-1.5.2.4.2.2.1"><a href="#section-5.4.2" class="auto internal xref">5.4.2</a>.  <a href="#name-the-update-function-3" class="internal xref">The Update Function</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.3">
                    <p id="section-toc.1-1.5.2.4.2.3.1"><a href="#section-5.4.3" class="auto internal xref">5.4.3</a>.  <a href="#name-the-absorb-function-3" class="internal xref">The Absorb Function</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.4">
                    <p id="section-toc.1-1.5.2.4.2.4.1"><a href="#section-5.4.4" class="auto internal xref">5.4.4</a>.  <a href="#name-the-enc-function-3" class="internal xref">The Enc Function</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.5">
                    <p id="section-toc.1-1.5.2.4.2.5.1"><a href="#section-5.4.5" class="auto internal xref">5.4.5</a>.  <a href="#name-the-dec-function-3" class="internal xref">The Dec Function</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.6">
                    <p id="section-toc.1-1.5.2.4.2.6.1"><a href="#section-5.4.6" class="auto internal xref">5.4.6</a>.  <a href="#name-the-decpartial-function-3" class="internal xref">The DecPartial Function</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.7">
                    <p id="section-toc.1-1.5.2.4.2.7.1"><a href="#section-5.4.7" class="auto internal xref">5.4.7</a>.  <a href="#name-the-finalize-function-3" class="internal xref">The Finalize Function</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="auto internal xref">5.5</a>.  <a href="#name-aegis-256x" class="internal xref">AEGIS-256X</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.1">
                    <p id="section-toc.1-1.5.2.5.2.1.1"><a href="#section-5.5.1" class="auto internal xref">5.5.1</a>.  <a href="#name-the-init-function-4" class="internal xref">The Init Function</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.2">
                    <p id="section-toc.1-1.5.2.5.2.2.1"><a href="#section-5.5.2" class="auto internal xref">5.5.2</a>.  <a href="#name-the-update-function-4" class="internal xref">The Update Function</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.3">
                    <p id="section-toc.1-1.5.2.5.2.3.1"><a href="#section-5.5.3" class="auto internal xref">5.5.3</a>.  <a href="#name-the-absorb-function-4" class="internal xref">The Absorb Function</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.4">
                    <p id="section-toc.1-1.5.2.5.2.4.1"><a href="#section-5.5.4" class="auto internal xref">5.5.4</a>.  <a href="#name-the-enc-function-4" class="internal xref">The Enc Function</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.5">
                    <p id="section-toc.1-1.5.2.5.2.5.1"><a href="#section-5.5.5" class="auto internal xref">5.5.5</a>.  <a href="#name-the-dec-function-4" class="internal xref">The Dec Function</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.6">
                    <p id="section-toc.1-1.5.2.5.2.6.1"><a href="#section-5.5.6" class="auto internal xref">5.5.6</a>.  <a href="#name-the-decpartial-function-4" class="internal xref">The DecPartial Function</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.7">
                    <p id="section-toc.1-1.5.2.5.2.7.1"><a href="#section-5.5.7" class="auto internal xref">5.5.7</a>.  <a href="#name-the-finalize-function-4" class="internal xref">The Finalize Function</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a href="#section-5.6" class="auto internal xref">5.6</a>.  <a href="#name-implementation-consideratio" class="internal xref">Implementation Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.7">
                <p id="section-toc.1-1.5.2.7.1"><a href="#section-5.7" class="auto internal xref">5.7</a>.  <a href="#name-operational-considerations" class="internal xref">Operational Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-encoding-ct-tag-tuples" class="internal xref">Encoding (ct, tag) Tuples</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-aegis-as-a-stream-cipher" class="internal xref">AEGIS as a Stream Cipher</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-implementation-status" class="internal xref">Implementation Status</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-usage-guidelines" class="internal xref">Usage Guidelines</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.1">
                    <p id="section-toc.1-1.9.2.1.2.1.1"><a href="#section-9.1.1" class="auto internal xref">9.1.1</a>.  <a href="#name-key-and-nonce-selection" class="internal xref">Key and Nonce Selection</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.2">
                    <p id="section-toc.1-1.9.2.1.2.2.1"><a href="#section-9.1.2" class="auto internal xref">9.1.2</a>.  <a href="#name-key-commitment" class="internal xref">Key Commitment</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.3">
                    <p id="section-toc.1-1.9.2.1.2.3.1"><a href="#section-9.1.3" class="auto internal xref">9.1.3</a>.  <a href="#name-multi-user-security" class="internal xref">Multi-User Security</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.4">
                    <p id="section-toc.1-1.9.2.1.2.4.1"><a href="#section-9.1.4" class="auto internal xref">9.1.4</a>.  <a href="#name-other-uses-of-aegis" class="internal xref">Other Uses of AEGIS</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-implementation-security" class="internal xref">Implementation Security</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="auto internal xref">9.3</a>.  <a href="#name-security-guarantees" class="internal xref">Security Guarantees</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-test-vectors" class="internal xref">Test Vectors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-aesround-test-vector" class="internal xref">AESRound Test Vector</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-aegis-128l-test-vectors" class="internal xref">AEGIS-128L Test Vectors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2.2.1">
                    <p id="section-toc.1-1.12.2.2.2.1.1"><a href="#appendix-A.2.1" class="auto internal xref">A.2.1</a>.  <a href="#name-update-test-vector" class="internal xref">Update Test Vector</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2.2.2">
                    <p id="section-toc.1-1.12.2.2.2.2.1"><a href="#appendix-A.2.2" class="auto internal xref">A.2.2</a>.  <a href="#name-test-vector-1" class="internal xref">Test Vector 1</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2.2.3">
                    <p id="section-toc.1-1.12.2.2.2.3.1"><a href="#appendix-A.2.3" class="auto internal xref">A.2.3</a>.  <a href="#name-test-vector-2" class="internal xref">Test Vector 2</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2.2.4">
                    <p id="section-toc.1-1.12.2.2.2.4.1"><a href="#appendix-A.2.4" class="auto internal xref">A.2.4</a>.  <a href="#name-test-vector-3" class="internal xref">Test Vector 3</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2.2.5">
                    <p id="section-toc.1-1.12.2.2.2.5.1"><a href="#appendix-A.2.5" class="auto internal xref">A.2.5</a>.  <a href="#name-test-vector-4" class="internal xref">Test Vector 4</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2.2.6">
                    <p id="section-toc.1-1.12.2.2.2.6.1"><a href="#appendix-A.2.6" class="auto internal xref">A.2.6</a>.  <a href="#name-test-vector-5" class="internal xref">Test Vector 5</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2.2.7">
                    <p id="section-toc.1-1.12.2.2.2.7.1"><a href="#appendix-A.2.7" class="auto internal xref">A.2.7</a>.  <a href="#name-test-vector-6" class="internal xref">Test Vector 6</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2.2.8">
                    <p id="section-toc.1-1.12.2.2.2.8.1"><a href="#appendix-A.2.8" class="auto internal xref">A.2.8</a>.  <a href="#name-test-vector-7" class="internal xref">Test Vector 7</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2.2.9">
                    <p id="section-toc.1-1.12.2.2.2.9.1"><a href="#appendix-A.2.9" class="auto internal xref">A.2.9</a>.  <a href="#name-test-vector-8" class="internal xref">Test Vector 8</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2.2.10">
                    <p id="section-toc.1-1.12.2.2.2.10.1"><a href="#appendix-A.2.10" class="auto internal xref">A.2.10</a>. <a href="#name-test-vector-9" class="internal xref">Test Vector 9</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#appendix-A.3" class="auto internal xref">A.3</a>.  <a href="#name-aegis-256-test-vectors" class="internal xref">AEGIS-256 Test Vectors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3.2.1">
                    <p id="section-toc.1-1.12.2.3.2.1.1"><a href="#appendix-A.3.1" class="auto internal xref">A.3.1</a>.  <a href="#name-update-test-vector-2" class="internal xref">Update Test Vector</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3.2.2">
                    <p id="section-toc.1-1.12.2.3.2.2.1"><a href="#appendix-A.3.2" class="auto internal xref">A.3.2</a>.  <a href="#name-test-vector-1-2" class="internal xref">Test Vector 1</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3.2.3">
                    <p id="section-toc.1-1.12.2.3.2.3.1"><a href="#appendix-A.3.3" class="auto internal xref">A.3.3</a>.  <a href="#name-test-vector-2-2" class="internal xref">Test Vector 2</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3.2.4">
                    <p id="section-toc.1-1.12.2.3.2.4.1"><a href="#appendix-A.3.4" class="auto internal xref">A.3.4</a>.  <a href="#name-test-vector-3-2" class="internal xref">Test Vector 3</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3.2.5">
                    <p id="section-toc.1-1.12.2.3.2.5.1"><a href="#appendix-A.3.5" class="auto internal xref">A.3.5</a>.  <a href="#name-test-vector-4-2" class="internal xref">Test Vector 4</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3.2.6">
                    <p id="section-toc.1-1.12.2.3.2.6.1"><a href="#appendix-A.3.6" class="auto internal xref">A.3.6</a>.  <a href="#name-test-vector-5-2" class="internal xref">Test Vector 5</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3.2.7">
                    <p id="section-toc.1-1.12.2.3.2.7.1"><a href="#appendix-A.3.7" class="auto internal xref">A.3.7</a>.  <a href="#name-test-vector-6-2" class="internal xref">Test Vector 6</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3.2.8">
                    <p id="section-toc.1-1.12.2.3.2.8.1"><a href="#appendix-A.3.8" class="auto internal xref">A.3.8</a>.  <a href="#name-test-vector-7-2" class="internal xref">Test Vector 7</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3.2.9">
                    <p id="section-toc.1-1.12.2.3.2.9.1"><a href="#appendix-A.3.9" class="auto internal xref">A.3.9</a>.  <a href="#name-test-vector-8-2" class="internal xref">Test Vector 8</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3.2.10">
                    <p id="section-toc.1-1.12.2.3.2.10.1"><a href="#appendix-A.3.10" class="auto internal xref">A.3.10</a>. <a href="#name-test-vector-9-2" class="internal xref">Test Vector 9</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.4">
                <p id="section-toc.1-1.12.2.4.1"><a href="#appendix-A.4" class="auto internal xref">A.4</a>.  <a href="#name-aegis-128x2-test-vectors" class="internal xref">AEGIS-128X2 Test Vectors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.4.2.1">
                    <p id="section-toc.1-1.12.2.4.2.1.1"><a href="#appendix-A.4.1" class="auto internal xref">A.4.1</a>.  <a href="#name-initial-state" class="internal xref">Initial State</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.4.2.2">
                    <p id="section-toc.1-1.12.2.4.2.2.1"><a href="#appendix-A.4.2" class="auto internal xref">A.4.2</a>.  <a href="#name-test-vector-1-3" class="internal xref">Test Vector 1</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.4.2.3">
                    <p id="section-toc.1-1.12.2.4.2.3.1"><a href="#appendix-A.4.3" class="auto internal xref">A.4.3</a>.  <a href="#name-test-vector-2-3" class="internal xref">Test Vector 2</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.5">
                <p id="section-toc.1-1.12.2.5.1"><a href="#appendix-A.5" class="auto internal xref">A.5</a>.  <a href="#name-aegis-128x4-test-vectors" class="internal xref">AEGIS-128X4 Test Vectors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.5.2.1">
                    <p id="section-toc.1-1.12.2.5.2.1.1"><a href="#appendix-A.5.1" class="auto internal xref">A.5.1</a>.  <a href="#name-initial-state-2" class="internal xref">Initial State</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.5.2.2">
                    <p id="section-toc.1-1.12.2.5.2.2.1"><a href="#appendix-A.5.2" class="auto internal xref">A.5.2</a>.  <a href="#name-test-vector-1-4" class="internal xref">Test Vector 1</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.5.2.3">
                    <p id="section-toc.1-1.12.2.5.2.3.1"><a href="#appendix-A.5.3" class="auto internal xref">A.5.3</a>.  <a href="#name-test-vector-2-4" class="internal xref">Test Vector 2</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.6">
                <p id="section-toc.1-1.12.2.6.1"><a href="#appendix-A.6" class="auto internal xref">A.6</a>.  <a href="#name-aegis-256x2-test-vectors" class="internal xref">AEGIS-256X2 Test Vectors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.6.2.1">
                    <p id="section-toc.1-1.12.2.6.2.1.1"><a href="#appendix-A.6.1" class="auto internal xref">A.6.1</a>.  <a href="#name-initial-state-3" class="internal xref">Initial State</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.6.2.2">
                    <p id="section-toc.1-1.12.2.6.2.2.1"><a href="#appendix-A.6.2" class="auto internal xref">A.6.2</a>.  <a href="#name-test-vector-1-5" class="internal xref">Test Vector 1</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.6.2.3">
                    <p id="section-toc.1-1.12.2.6.2.3.1"><a href="#appendix-A.6.3" class="auto internal xref">A.6.3</a>.  <a href="#name-test-vector-2-5" class="internal xref">Test Vector 2</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.7">
                <p id="section-toc.1-1.12.2.7.1"><a href="#appendix-A.7" class="auto internal xref">A.7</a>.  <a href="#name-aegis-256x4-test-vectors" class="internal xref">AEGIS-256X4 Test Vectors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.7.2.1">
                    <p id="section-toc.1-1.12.2.7.2.1.1"><a href="#appendix-A.7.1" class="auto internal xref">A.7.1</a>.  <a href="#name-initial-state-4" class="internal xref">Initial State</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.7.2.2">
                    <p id="section-toc.1-1.12.2.7.2.2.1"><a href="#appendix-A.7.2" class="auto internal xref">A.7.2</a>.  <a href="#name-test-vector-1-6" class="internal xref">Test Vector 1</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.7.2.3">
                    <p id="section-toc.1-1.12.2.7.2.3.1"><a href="#appendix-A.7.3" class="auto internal xref">A.7.3</a>.  <a href="#name-test-vector-2-6" class="internal xref">Test Vector 2</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document describes the AEGIS family of authenticated encryption with associated data (AEAD) algorithms <span>[<a href="#AEGIS" class="cite xref">AEGIS</a>]</span>, which were chosen for high-performance applications in the CAESAR (Competition for Authenticated Encryption: Security, Applicability, and Robustness) competition.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Among the finalists, AEGIS-128 was chosen as the winner for this category. However, AEGIS-128L, another finalist, offers enhanced performance and a stronger security margin <span>[<a href="#ENP19" class="cite xref">ENP19</a>]</span> <span>[<a href="#JLD21" class="cite xref">JLD21</a>]</span> <span>[<a href="#LIMS21" class="cite xref">LIMS21</a>]</span> <span>[<a href="#STSI23" class="cite xref">STSI23</a>]</span>.
Additionally, AEGIS-256, which also reached the final round, provides 256-bit security and supports higher usage limits.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Therefore, this document specifies the following variants:<a href="#section-1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-4.1">
          <p id="section-1-4.1.1">AEGIS-128L, which has a 128-bit key, a 128-bit nonce, a 1024-bit state, a 128- or 256-bit authentication tag, and processes 256-bit input blocks.<a href="#section-1-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-4.2">
          <p id="section-1-4.2.1">AEGIS-256, which has a 256-bit key, a 256-bit nonce, a 768-bit state, a 128- or 256-bit authentication tag, and processes 128-bit input blocks.<a href="#section-1-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-4.3">
          <p id="section-1-4.3.1">AEGIS-128X, which is a mode based on AEGIS-128L, specialized for CPUs with large vector registers and vector AES instructions.<a href="#section-1-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-4.4">
          <p id="section-1-4.4.1">AEGIS-256X, which is a mode based on AEGIS-256, specialized for CPUs with large vector registers and vector AES instructions.<a href="#section-1-4.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-5">All variants are inverse-free and constructed from the AES encryption round function <span>[<a href="#FIPS-AES" class="cite xref">FIPS-AES</a>]</span>.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">The AEGIS cipher family offers performance that significantly exceeds that of AES-GCM on CPUs with AES instructions. Similarly, software implementations not using AES instructions can also be faster, although to a lesser extent.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">Unlike with AES-GCM, nonces can be safely chosen at random with no practical limit when using AEGIS-256 and AEGIS-256X. AEGIS-128L and AEGIS-128X also allow for more messages to be safely encrypted when using random nonces.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">With some existing AEAD schemes, such as AES-GCM, an attacker can generate a ciphertext that successfully decrypts under multiple different keys (a partitioning oracle attack) <span>[<a href="#LGR21" class="cite xref">LGR21</a>]</span>. This ability to craft a (ciphertext, authentication tag) pair that verifies under multiple keys significantly reduces the number of required interactions with the oracle to perform an exhaustive search, making it practical if the key space is small. For example, with password-based encryption, an attacker can guess a large number of passwords at a time by recursively submitting such a ciphertext to an oracle, which speeds up a password search by reducing it to a binary search.<a href="#section-1-8" class="pilcrow">¶</a></p>
<p id="section-1-9">In AEGIS, finding distinct (key, nonce) pairs that successfully decrypt a given (associated data, ciphertext, authentication tag) tuple is believed to have a complexity that depends on the tag size. A 128-bit tag provides 64-bit committing security, which is generally acceptable for interactive protocols. With a 256-bit tag, finding a collision becomes impractical.<a href="#section-1-9" class="pilcrow">¶</a></p>
<p id="section-1-10">Unlike most other AES-based AEAD constructions, leaking a state does not leak the key or previous states.<a href="#section-1-10" class="pilcrow">¶</a></p>
<p id="section-1-11">Finally, an AEGIS key is not required after the initialization function, and there is no key schedule. Thus, ephemeral keys can be erased from memory before any data has been encrypted or decrypted, mitigating cold boot attacks.<a href="#section-1-11" class="pilcrow">¶</a></p>
<p id="section-1-12">Note that an earlier version of Hongjun Wu and Bart Preneel’s paper introducing AEGIS specified AEGIS-128L and AEGIS-256 sporting differences with regards to the computation of the authentication tag and the number of state updates in the <code>Finalize()</code> function. We follow the specification of <span>[<a href="#AEGIS" class="cite xref">AEGIS</a>]</span>, which can be found in the References section of this document.<a href="#section-1-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words “<span class="bcp14">MUST</span>”, “<span class="bcp14">MUST NOT</span>”, “<span class="bcp14">REQUIRED</span>”, “<span class="bcp14">SHALL</span>”, “<span class="bcp14">SHALL NOT</span>”, “<span class="bcp14">SHOULD</span>”, “<span class="bcp14">SHOULD NOT</span>”, “<span class="bcp14">RECOMMENDED</span>”, “<span class="bcp14">NOT RECOMMENDED</span>”,
“<span class="bcp14">MAY</span>”, and “<span class="bcp14">OPTIONAL</span>” in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">Throughout this document, “byte” is used interchangeably with “octet” and refers to an 8-bit sequence.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">Primitives:<a href="#section-2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-4.1">
          <p id="section-2-4.1.1"><code>{}</code>: an empty bit array.<a href="#section-2-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-4.2">
          <p id="section-2-4.2.1"><code>|x|</code>: the length of <code>x</code> in bits.<a href="#section-2-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-4.3">
          <p id="section-2-4.3.1"><code>a ^ b</code>: the bitwise exclusive OR operation between <code>a</code> and <code>b</code>.<a href="#section-2-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-4.4">
          <p id="section-2-4.4.1"><code>a &amp; b</code>: the bitwise AND operation between <code>a</code> and <code>b</code>.<a href="#section-2-4.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-4.5">
          <p id="section-2-4.5.1"><code>a || b</code>: the concatenation of <code>a</code> and <code>b</code>.<a href="#section-2-4.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-4.6">
          <p id="section-2-4.6.1"><code>a mod b</code>: the remainder of the Euclidean division between <code>a</code> as the dividend and <code>b</code> as the divisor.<a href="#section-2-4.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-4.7">
          <p id="section-2-4.7.1"><code>LE64(x)</code>: the little-endian encoding of unsigned 64-bit integer <code>x</code>.<a href="#section-2-4.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-4.8">
          <p id="section-2-4.8.1"><code>ZeroPad(x, n)</code>: padding operation. Trailing zeros are concatenated to <code>x</code> until the total length is a multiple of <code>n</code> bits.<a href="#section-2-4.8.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-4.9">
          <p id="section-2-4.9.1"><code>Truncate(x, n)</code>: truncation operation. The first <code>n</code> bits of <code>x</code> are kept.<a href="#section-2-4.9.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-4.10">
          <p id="section-2-4.10.1"><code>Split(x, n)</code>: splitting operation. <code>x</code> is split into <code>n</code>-bit blocks, ignoring partial blocks.<a href="#section-2-4.10.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-4.11">
          <p id="section-2-4.11.1"><code>Tail(x, n)</code>: returns the last <code>n</code> bits of <code>x</code>.<a href="#section-2-4.11.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-4.12">
          <p id="section-2-4.12.1"><code>AESRound(in, rk)</code>: a single round of the AES encryption round function, which is the composition of the <code>SubBytes</code>, <code>ShiftRows</code>, <code>MixColums</code> and <code>AddRoundKey</code> transformations, as defined in section 5 of <span>[<a href="#FIPS-AES" class="cite xref">FIPS-AES</a>]</span>. Here, <code>in</code> is the 128-bit AES input state, and <code>rk</code> is the 128-bit round key.<a href="#section-2-4.12.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-4.13">
          <p id="section-2-4.13.1"><code>Repeat(n, F)</code>: <code>n</code> sequential evaluations of the function <code>F</code>.<a href="#section-2-4.13.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-4.14">
          <p id="section-2-4.14.1"><code>CtEq(a, b)</code>: compares <code>a</code> and <code>b</code> in constant-time, returning <code>True</code> for an exact match, <code>False</code> otherwise.<a href="#section-2-4.14.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-2-5">AEGIS internal functions:<a href="#section-2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-6.1">
          <p id="section-2-6.1.1"><code>Update(M0, M1)</code> or <code>Update(M)</code>: the state update function.<a href="#section-2-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-6.2">
          <p id="section-2-6.2.1"><code>Init(key, nonce)</code>: the initialization function.<a href="#section-2-6.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-6.3">
          <p id="section-2-6.3.1"><code>Absorb(ai)</code>: the input block absorption function.<a href="#section-2-6.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-6.4">
          <p id="section-2-6.4.1"><code>Enc(xi)</code>: the input block encryption function.<a href="#section-2-6.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-6.5">
          <p id="section-2-6.5.1"><code>Dec(ci)</code>: the input block decryption function.<a href="#section-2-6.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-6.6">
          <p id="section-2-6.6.1"><code>DecPartial(cn)</code>: the input block decryption function for the last ciphertext bits when they do not fill an entire block.<a href="#section-2-6.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-6.7">
          <p id="section-2-6.7.1"><code>Finalize(ad_len_bits, msg_len_bits)</code>: the authentication tag generation function.<a href="#section-2-6.7.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-2-7">Input blocks are 256 bits for AEGIS-128L and 128 bits for AEGIS-256.<a href="#section-2-7" class="pilcrow">¶</a></p>
<p id="section-2-8">AES blocks:<a href="#section-2-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-9.1">
          <p id="section-2-9.1.1"><code>Si</code>: the <code>i</code>-th AES block of the current state.<a href="#section-2-9.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-9.2">
          <p id="section-2-9.2.1"><code>S'i</code>: the <code>i</code>-th AES block of the next state.<a href="#section-2-9.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-9.3">
          <p id="section-2-9.3.1"><code>{Si, ...Sj}</code>: the vector of the <code>i</code>-th AES block of the current state to the <code>j</code>-th block of the current state.<a href="#section-2-9.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-9.4">
          <p id="section-2-9.4.1"><code>C0</code>: an AES block built from the following bytes in hexadecimal format: <code>{ 0x00, 0x01, 0x01, 0x02, 0x03, 0x05, 0x08, 0x0d, 0x15, 0x22, 0x37, 0x59, 0x90, 0xe9, 0x79, 0x62 }</code>.<a href="#section-2-9.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-9.5">
          <p id="section-2-9.5.1"><code>C1</code>: an AES block built from the following bytes in hexadecimal format: <code>{ 0xdb, 0x3d, 0x18, 0x55, 0x6d, 0xc2, 0x2f, 0xf1, 0x20, 0x11, 0x31, 0x42, 0x73, 0xb5, 0x28, 0xdd }</code>.<a href="#section-2-9.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-2-10">AES blocks are always 128 bits in length.<a href="#section-2-10" class="pilcrow">¶</a></p>
<p id="section-2-11">Input and output values:<a href="#section-2-11" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-12.1">
          <p id="section-2-12.1.1"><code>key</code>: the encryption key (128 bits for AEGIS-128L, 256 bits for AEGIS-256).<a href="#section-2-12.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-12.2">
          <p id="section-2-12.2.1"><code>nonce</code>: the public nonce (128 bits for AEGIS-128L, 256 bits for AEGIS-256).<a href="#section-2-12.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-12.3">
          <p id="section-2-12.3.1"><code>ad</code>: the associated data.<a href="#section-2-12.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-12.4">
          <p id="section-2-12.4.1"><code>msg</code>: the plaintext.<a href="#section-2-12.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-12.5">
          <p id="section-2-12.5.1"><code>ct</code>: the ciphertext.<a href="#section-2-12.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-12.6">
          <p id="section-2-12.6.1"><code>tag</code>: the authentication tag (128 or 256 bits).<a href="#section-2-12.6.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="the-aegis-128l-algorithm">
<section id="section-3">
      <h2 id="name-the-aegis-128l-algorithm">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-the-aegis-128l-algorithm" class="section-name selfRef">The AEGIS-128L Algorithm</a>
      </h2>
<p id="section-3-1">AEGIS-128L has a 1024-bit state, made of eight 128-bit blocks <code>{S0, ...S7}</code>.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">The parameters for this algorithm, whose meaning is defined in <span>[<a href="#RFC5116" class="cite xref">RFC5116</a>], <a href="https://rfc-editor.org/rfc/rfc5116#section-4" class="relref">Section 4</a></span> are:<a href="#section-3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-3.1">
          <p id="section-3-3.1.1"><code>K_LEN</code> (key length) is 16 bytes (128 bits).<a href="#section-3-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-3.2">
          <p id="section-3-3.2.1"><code>P_MAX</code> (maximum length of the plaintext) is 2<sup>61</sup> - 1 bytes (2<sup>64</sup> - 8 bits).<a href="#section-3-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-3.3">
          <p id="section-3-3.3.1"><code>A_MAX</code> (maximum length of the associated data) is 2<sup>61</sup> - 1 bytes (2<sup>64</sup> - 8 bits).<a href="#section-3-3.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-3.4">
          <p id="section-3-3.4.1"><code>N_MIN</code> (minimum nonce length) = <code>N_MAX</code> (maximum nonce length) = 16 bytes (128 bits).<a href="#section-3-3.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-3.5">
          <p id="section-3-3.5.1"><code>C_MAX</code> (maximum ciphertext length) = <code>P_MAX</code> + tag length = (2<sup>61</sup> - 1) + 16 or 32 bytes (in bits: (2<sup>64</sup> - 8) + 128 or 256 bits).<a href="#section-3-3.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-3-4">Distinct associated data inputs, as described in <span>[<a href="#RFC5116" class="cite xref">RFC5116</a>], <a href="https://rfc-editor.org/rfc/rfc5116#section-3" class="relref">Section 3</a></span> shall be unambiguously encoded as a single input.
It is up to the application to create a structure in the associated data input if needed.<a href="#section-3-4" class="pilcrow">¶</a></p>
<div id="authenticated-encryption">
<section id="section-3.1">
        <h3 id="name-authenticated-encryption">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-authenticated-encryption" class="section-name selfRef">Authenticated Encryption</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-3.1-1">
<pre>
Encrypt(msg, ad, key, nonce)
</pre><a href="#section-3.1-1" class="pilcrow">¶</a>
</div>
<p id="section-3.1-2">The <code>Encrypt</code> function encrypts a message and returns the ciphertext along with an authentication tag that verifies the authenticity of the message and associated data, if provided.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">Security:<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-4.1">
            <p id="section-3.1-4.1.1">For a given key, the nonce <span class="bcp14">MUST NOT</span> be reused under any circumstances; doing so allows an attacker to recover the internal state.<a href="#section-3.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-4.2">
            <p id="section-3.1-4.2.1">The key <span class="bcp14">MUST</span> be randomly chosen from a uniform distribution.<a href="#section-3.1-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.1-5">Inputs:<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-6.1">
            <p id="section-3.1-6.1.1"><code>msg</code>: the message to be encrypted (length <span class="bcp14">MUST</span> be less than or equal to <code>P_MAX</code>).<a href="#section-3.1-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-6.2">
            <p id="section-3.1-6.2.1"><code>ad</code>: the associated data to authenticate (length <span class="bcp14">MUST</span> be less than or equal to <code>A_MAX</code>).<a href="#section-3.1-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-6.3">
            <p id="section-3.1-6.3.1"><code>key</code>: the encryption key.<a href="#section-3.1-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-6.4">
            <p id="section-3.1-6.4.1"><code>nonce</code>: the public nonce.<a href="#section-3.1-6.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.1-7">Outputs:<a href="#section-3.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-8.1">
            <p id="section-3.1-8.1.1"><code>ct</code>: the ciphertext.<a href="#section-3.1-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-8.2">
            <p id="section-3.1-8.2.1"><code>tag</code>: the authentication tag.<a href="#section-3.1-8.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.1-9">Steps:<a href="#section-3.1-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1-10">
<pre>
Init(key, nonce)

ct = {}

ad_blocks = Split(ZeroPad(ad, 256), 256)
for ai in ad_blocks:
    Absorb(ai)

msg_blocks = Split(ZeroPad(msg, 256), 256)
for xi in msg_blocks:
    ct = ct || Enc(xi)

tag = Finalize(|ad|, |msg|)
ct = Truncate(ct, |msg|)

return ct and tag
</pre><a href="#section-3.1-10" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="authenticated-decryption">
<section id="section-3.2">
        <h3 id="name-authenticated-decryption">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-authenticated-decryption" class="section-name selfRef">Authenticated Decryption</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-3.2-1">
<pre>
Decrypt(ct, tag, ad, key, nonce)
</pre><a href="#section-3.2-1" class="pilcrow">¶</a>
</div>
<p id="section-3.2-2">The <code>Decrypt</code> function decrypts a ciphertext, verifies that the authentication tag is correct, and returns the message on success or an error if tag verification failed.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">Security:<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-4.1">
            <p id="section-3.2-4.1.1">If tag verification fails, the decrypted message and wrong message authentication tag <span class="bcp14">MUST NOT</span> be given as output. The decrypted message <span class="bcp14">MUST</span> be overwritten with zeros before being returned.<a href="#section-3.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-4.2">
            <p id="section-3.2-4.2.1">The comparison of the input <code>tag</code> with the <code>expected_tag</code> <span class="bcp14">MUST</span> be done in constant time.<a href="#section-3.2-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.2-5">Inputs:<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-6.1">
            <p id="section-3.2-6.1.1"><code>ct</code>: the ciphertext to be decrypted (length <span class="bcp14">MUST</span> be less than or equal to <code>C_MAX</code>).<a href="#section-3.2-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-6.2">
            <p id="section-3.2-6.2.1"><code>tag</code>: the authentication tag.<a href="#section-3.2-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-6.3">
            <p id="section-3.2-6.3.1"><code>ad</code>: the associated data to authenticate (length <span class="bcp14">MUST</span> be less than or equal to <code>A_MAX</code>).<a href="#section-3.2-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-6.4">
            <p id="section-3.2-6.4.1"><code>key</code>: the encryption key.<a href="#section-3.2-6.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-6.5">
            <p id="section-3.2-6.5.1"><code>nonce</code>: the public nonce.<a href="#section-3.2-6.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.2-7">Outputs:<a href="#section-3.2-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-8.1">
            <p id="section-3.2-8.1.1">Either the decrypted message <code>msg</code> or an error indicating that the authentication tag is invalid for the given inputs.<a href="#section-3.2-8.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.2-9">Steps:<a href="#section-3.2-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2-10">
<pre>
Init(key, nonce)

msg = {}

ad_blocks = Split(ZeroPad(ad, 256), 256)
for ai in ad_blocks:
    Absorb(ai)

ct_blocks = Split(ct, 256)
cn = Tail(ct, |ct| mod 256)

for ci in ct_blocks:
    msg = msg || Dec(ci)

if cn is not empty:
    msg = msg || DecPartial(cn)

expected_tag = Finalize(|ad|, |msg|)

if CtEq(tag, expected_tag) is False:
    erase msg
    return "verification failed" error
else:
    return msg
</pre><a href="#section-3.2-10" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-init-function">
<section id="section-3.3">
        <h3 id="name-the-init-function">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-the-init-function" class="section-name selfRef">The Init Function</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-3.3-1">
<pre>
Init(key, nonce)
</pre><a href="#section-3.3-1" class="pilcrow">¶</a>
</div>
<p id="section-3.3-2">The <code>Init</code> function constructs the initial state <code>{S0, ...S7}</code> using the given <code>key</code> and <code>nonce</code>.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">Inputs:<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-4.1">
            <p id="section-3.3-4.1.1"><code>key</code>: the encryption key.<a href="#section-3.3-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-4.2">
            <p id="section-3.3-4.2.1"><code>nonce</code>: the public nonce.<a href="#section-3.3-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.3-5">Defines:<a href="#section-3.3-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-6.1">
            <p id="section-3.3-6.1.1"><code>{S0, ...S7}</code>: the initial state.<a href="#section-3.3-6.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.3-7">Steps:<a href="#section-3.3-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.3-8">
<pre>
S0 = key ^ nonce
S1 = C1
S2 = C0
S3 = C1
S4 = key ^ nonce
S5 = key ^ C0
S6 = key ^ C1
S7 = key ^ C0

Repeat(10, Update(nonce, key))
</pre><a href="#section-3.3-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-update-function">
<section id="section-3.4">
        <h3 id="name-the-update-function">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-the-update-function" class="section-name selfRef">The Update Function</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-3.4-1">
<pre>
Update(M0, M1)
</pre><a href="#section-3.4-1" class="pilcrow">¶</a>
</div>
<p id="section-3.4-2">The <code>Update</code> function is the core of the AEGIS-128L algorithm.
It updates the state <code>{S0, ...S7}</code> using two 128-bit values.<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<p id="section-3.4-3">Inputs:<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-4.1">
            <p id="section-3.4-4.1.1"><code>M0</code>: the first 128-bit block to be absorbed.<a href="#section-3.4-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-4.2">
            <p id="section-3.4-4.2.1"><code>M1</code>: the second 128-bit block to be absorbed.<a href="#section-3.4-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.4-5">Modifies:<a href="#section-3.4-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-6.1">
            <p id="section-3.4-6.1.1"><code>{S0, ...S7}</code>: the state.<a href="#section-3.4-6.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.4-7">Steps:<a href="#section-3.4-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.4-8">
<pre>
S'0 = AESRound(S7, S0 ^ M0)
S'1 = AESRound(S0, S1)
S'2 = AESRound(S1, S2)
S'3 = AESRound(S2, S3)
S'4 = AESRound(S3, S4 ^ M1)
S'5 = AESRound(S4, S5)
S'6 = AESRound(S5, S6)
S'7 = AESRound(S6, S7)

S0  = S'0
S1  = S'1
S2  = S'2
S3  = S'3
S4  = S'4
S5  = S'5
S6  = S'6
S7  = S'7
</pre><a href="#section-3.4-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-absorb-function">
<section id="section-3.5">
        <h3 id="name-the-absorb-function">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-the-absorb-function" class="section-name selfRef">The Absorb Function</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-3.5-1">
<pre>
Absorb(ai)
</pre><a href="#section-3.5-1" class="pilcrow">¶</a>
</div>
<p id="section-3.5-2">The <code>Absorb</code> function absorbs a 256-bit input block <code>ai</code> into the state <code>{S0, ...S7}</code>.<a href="#section-3.5-2" class="pilcrow">¶</a></p>
<p id="section-3.5-3">Inputs:<a href="#section-3.5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5-4.1">
            <p id="section-3.5-4.1.1"><code>ai</code>: the 256-bit input block.<a href="#section-3.5-4.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.5-5">Steps:<a href="#section-3.5-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.5-6">
<pre>
t0, t1 = Split(ai, 128)
Update(t0, t1)
</pre><a href="#section-3.5-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-enc-function">
<section id="section-3.6">
        <h3 id="name-the-enc-function">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-the-enc-function" class="section-name selfRef">The Enc Function</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-3.6-1">
<pre>
Enc(xi)
</pre><a href="#section-3.6-1" class="pilcrow">¶</a>
</div>
<p id="section-3.6-2">The <code>Enc</code> function encrypts a 256-bit input block <code>xi</code> using the state <code>{S0, ...S7}</code>.<a href="#section-3.6-2" class="pilcrow">¶</a></p>
<p id="section-3.6-3">Inputs:<a href="#section-3.6-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.6-4.1">
            <p id="section-3.6-4.1.1"><code>xi</code>: the 256-bit input block.<a href="#section-3.6-4.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.6-5">Outputs:<a href="#section-3.6-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.6-6.1">
            <p id="section-3.6-6.1.1"><code>ci</code>: the 256-bit encrypted block.<a href="#section-3.6-6.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.6-7">Steps:<a href="#section-3.6-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.6-8">
<pre>
z0 = S6 ^ S1 ^ (S2 &amp; S3)
z1 = S2 ^ S5 ^ (S6 &amp; S7)

t0, t1 = Split(xi, 128)
out0 = t0 ^ z0
out1 = t1 ^ z1

Update(t0, t1)
ci = out0 || out1

return ci
</pre><a href="#section-3.6-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-dec-function">
<section id="section-3.7">
        <h3 id="name-the-dec-function">
<a href="#section-3.7" class="section-number selfRef">3.7. </a><a href="#name-the-dec-function" class="section-name selfRef">The Dec Function</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-3.7-1">
<pre>
Dec(ci)
</pre><a href="#section-3.7-1" class="pilcrow">¶</a>
</div>
<p id="section-3.7-2">The <code>Dec</code> function decrypts a 256-bit input block <code>ci</code> using the state <code>{S0, ...S7}</code>.<a href="#section-3.7-2" class="pilcrow">¶</a></p>
<p id="section-3.7-3">Inputs:<a href="#section-3.7-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.7-4.1">
            <p id="section-3.7-4.1.1"><code>ci</code>: the 256-bit encrypted block.<a href="#section-3.7-4.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.7-5">Outputs:<a href="#section-3.7-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.7-6.1">
            <p id="section-3.7-6.1.1"><code>xi</code>: the 256-bit decrypted block.<a href="#section-3.7-6.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.7-7">Steps:<a href="#section-3.7-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.7-8">
<pre>
z0 = S6 ^ S1 ^ (S2 &amp; S3)
z1 = S2 ^ S5 ^ (S6 &amp; S7)

t0, t1 = Split(ci, 128)
out0 = t0 ^ z0
out1 = t1 ^ z1

Update(out0, out1)
xi = out0 || out1

return xi
</pre><a href="#section-3.7-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-decpartial-function">
<section id="section-3.8">
        <h3 id="name-the-decpartial-function">
<a href="#section-3.8" class="section-number selfRef">3.8. </a><a href="#name-the-decpartial-function" class="section-name selfRef">The DecPartial Function</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-3.8-1">
<pre>
DecPartial(cn)
</pre><a href="#section-3.8-1" class="pilcrow">¶</a>
</div>
<p id="section-3.8-2">The <code>DecPartial</code> function decrypts the last ciphertext bits <code>cn</code> using the state <code>{S0, ...S7}</code> when they do not fill an entire block.<a href="#section-3.8-2" class="pilcrow">¶</a></p>
<p id="section-3.8-3">Inputs:<a href="#section-3.8-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.8-4.1">
            <p id="section-3.8-4.1.1"><code>cn</code>: the encrypted input.<a href="#section-3.8-4.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.8-5">Outputs:<a href="#section-3.8-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.8-6.1">
            <p id="section-3.8-6.1.1"><code>xn</code>: the decryption of <code>cn</code>.<a href="#section-3.8-6.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.8-7">Steps:<a href="#section-3.8-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.8-8">
<pre>
z0 = S6 ^ S1 ^ (S2 &amp; S3)
z1 = S2 ^ S5 ^ (S6 &amp; S7)

t0, t1 = Split(ZeroPad(cn, 256), 128)
out0 = t0 ^ z0
out1 = t1 ^ z1

xn = Truncate(out0 || out1, |cn|)

v0, v1 = Split(ZeroPad(xn, 256), 128)
Update(v0, v1)

return xn
</pre><a href="#section-3.8-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-finalize-function">
<section id="section-3.9">
        <h3 id="name-the-finalize-function">
<a href="#section-3.9" class="section-number selfRef">3.9. </a><a href="#name-the-finalize-function" class="section-name selfRef">The Finalize Function</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-3.9-1">
<pre>
Finalize(ad_len_bits, msg_len_bits)
</pre><a href="#section-3.9-1" class="pilcrow">¶</a>
</div>
<p id="section-3.9-2">The <code>Finalize</code> function computes a 128- or 256-bit tag that authenticates the message and associated data.<a href="#section-3.9-2" class="pilcrow">¶</a></p>
<p id="section-3.9-3">Inputs:<a href="#section-3.9-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.9-4.1">
            <p id="section-3.9-4.1.1"><code>ad_len_bits</code>: the length of the associated data in bits.<a href="#section-3.9-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.9-4.2">
            <p id="section-3.9-4.2.1"><code>msg_len_bits</code>: the length of the message in bits.<a href="#section-3.9-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.9-5">Outputs:<a href="#section-3.9-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.9-6.1">
            <p id="section-3.9-6.1.1"><code>tag</code>: the authentication tag.<a href="#section-3.9-6.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.9-7">Steps:<a href="#section-3.9-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.9-8">
<pre>
t = S2 ^ (LE64(ad_len_bits) || LE64(msg_len_bits))

Repeat(7, Update(t, t))

if tag_length == 16: # 128 bits
    tag = S0 ^ S1 ^ S2 ^ S3 ^ S4 ^ S5 ^ S6
else:                # 256 bits
    tag = (S0 ^ S1 ^ S2 ^ S3) || (S4 ^ S5 ^ S6 ^ S7)

return tag
</pre><a href="#section-3.9-8" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="the-aegis-256-algorithm">
<section id="section-4">
      <h2 id="name-the-aegis-256-algorithm">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-the-aegis-256-algorithm" class="section-name selfRef">The AEGIS-256 Algorithm</a>
      </h2>
<p id="section-4-1">AEGIS-256 has a 768-bit state, made of six 128-bit blocks <code>{S0, ...S5}</code>.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">The parameters for this algorithm, whose meaning is defined in <span>[<a href="#RFC5116" class="cite xref">RFC5116</a>], <a href="https://rfc-editor.org/rfc/rfc5116#section-4" class="relref">Section 4</a></span> are:<a href="#section-4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-3.1">
          <p id="section-4-3.1.1"><code>K_LEN</code> (key length) is 32 bytes (256 bits).<a href="#section-4-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-3.2">
          <p id="section-4-3.2.1"><code>P_MAX</code> (maximum length of the plaintext) is 2<sup>61</sup> - 1 bytes (2<sup>64</sup> - 8 bits).<a href="#section-4-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-3.3">
          <p id="section-4-3.3.1"><code>A_MAX</code> (maximum length of the associated data) is 2<sup>61</sup> bytes (2<sup>64</sup> bits).<a href="#section-4-3.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-3.4">
          <p id="section-4-3.4.1"><code>N_MIN</code> (minimum nonce length) = <code>N_MAX</code> (maximum nonce length) = 32 bytes (256 bits).<a href="#section-4-3.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-3.5">
          <p id="section-4-3.5.1"><code>C_MAX</code> (maximum ciphertext length) = <code>P_MAX</code> + tag length = (2<sup>61</sup> - 1) + 16 or 32 bytes (in bits: (2<sup>64</sup> - 8) + 128 or 256 bits).<a href="#section-4-3.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-4">Distinct associated data inputs, as described in <span>[<a href="#RFC5116" class="cite xref">RFC5116</a>], <a href="https://rfc-editor.org/rfc/rfc5116#section-3" class="relref">Section 3</a></span> shall be unambiguously encoded as a single input.
It is up to the application to create a structure in the associated data input if needed.<a href="#section-4-4" class="pilcrow">¶</a></p>
<div id="authenticated-encryption-1">
<section id="section-4.1">
        <h3 id="name-authenticated-encryption-2">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-authenticated-encryption-2" class="section-name selfRef">Authenticated Encryption</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-4.1-1">
<pre>
Encrypt(msg, ad, key, nonce)
</pre><a href="#section-4.1-1" class="pilcrow">¶</a>
</div>
<p id="section-4.1-2">The <code>Encrypt</code> function encrypts a message and returns the ciphertext along with an authentication tag that verifies the authenticity of the message and associated data, if provided.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">Security:<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-4.1">
            <p id="section-4.1-4.1.1">For a given key, the nonce <span class="bcp14">MUST NOT</span> be reused under any circumstances; doing so allows an attacker to recover the internal state.<a href="#section-4.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-4.2">
            <p id="section-4.1-4.2.1">The key <span class="bcp14">MUST</span> be randomly chosen from a uniform distribution.<a href="#section-4.1-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.1-5">Inputs:<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-6.1">
            <p id="section-4.1-6.1.1"><code>msg</code>: the message to be encrypted (length <span class="bcp14">MUST</span> be less than or equal to <code>P_MAX</code>).<a href="#section-4.1-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-6.2">
            <p id="section-4.1-6.2.1"><code>ad</code>: the associated data to authenticate (length <span class="bcp14">MUST</span> be less than or equal to <code>A_MAX</code>).<a href="#section-4.1-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-6.3">
            <p id="section-4.1-6.3.1"><code>key</code>: the encryption key.<a href="#section-4.1-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-6.4">
            <p id="section-4.1-6.4.1"><code>nonce</code>: the public nonce.<a href="#section-4.1-6.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.1-7">Outputs:<a href="#section-4.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-8.1">
            <p id="section-4.1-8.1.1"><code>ct</code>: the ciphertext.<a href="#section-4.1-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-8.2">
            <p id="section-4.1-8.2.1"><code>tag</code>: the authentication tag.<a href="#section-4.1-8.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.1-9">Steps:<a href="#section-4.1-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-10">
<pre>
Init(key, nonce)

ct = {}

ad_blocks = Split(ZeroPad(ad, 128), 128)
for ai in ad_blocks:
    Absorb(ai)

msg_blocks = Split(ZeroPad(msg, 128), 128)
for xi in msg_blocks:
    ct = ct || Enc(xi)

tag = Finalize(|ad|, |msg|)
ct = Truncate(ct, |msg|)

return ct and tag
</pre><a href="#section-4.1-10" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="authenticated-decryption-1">
<section id="section-4.2">
        <h3 id="name-authenticated-decryption-2">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-authenticated-decryption-2" class="section-name selfRef">Authenticated Decryption</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-4.2-1">
<pre>
Decrypt(ct, tag, ad, key, nonce)
</pre><a href="#section-4.2-1" class="pilcrow">¶</a>
</div>
<p id="section-4.2-2">The <code>Decrypt</code> function decrypts a ciphertext, verifies that the authentication tag is correct, and returns the message on success or an error if tag verification failed.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">Security:<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-4.1">
            <p id="section-4.2-4.1.1">If tag verification fails, the decrypted message and wrong message authentication tag <span class="bcp14">MUST NOT</span> be given as output. The decrypted message <span class="bcp14">MUST</span> be overwritten with zeros.<a href="#section-4.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-4.2">
            <p id="section-4.2-4.2.1">The comparison of the input <code>tag</code> with the <code>expected_tag</code> <span class="bcp14">MUST</span> be done in constant time.<a href="#section-4.2-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.2-5">Inputs:<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-6.1">
            <p id="section-4.2-6.1.1"><code>ct</code>: the ciphertext to be decrypted (length <span class="bcp14">MUST</span> be less than or equal to <code>C_MAX</code>).<a href="#section-4.2-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-6.2">
            <p id="section-4.2-6.2.1"><code>tag</code>: the authentication tag.<a href="#section-4.2-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-6.3">
            <p id="section-4.2-6.3.1"><code>ad</code>: the associated data to authenticate (length <span class="bcp14">MUST</span> be less than or equal to <code>A_MAX</code>).<a href="#section-4.2-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-6.4">
            <p id="section-4.2-6.4.1"><code>key</code>: the encryption key.<a href="#section-4.2-6.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-6.5">
            <p id="section-4.2-6.5.1"><code>nonce</code>: the public nonce.<a href="#section-4.2-6.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.2-7">Outputs:<a href="#section-4.2-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-8.1">
            <p id="section-4.2-8.1.1">Either the decrypted message <code>msg</code> or an error indicating that the authentication tag is invalid for the given inputs.<a href="#section-4.2-8.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.2-9">Steps:<a href="#section-4.2-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-10">
<pre>
Init(key, nonce)

msg = {}

ad_blocks = Split(ZeroPad(ad, 128), 128)
for ai in ad_blocks:
    Absorb(ai)

ct_blocks = Split(ZeroPad(ct, 128), 128)
cn = Tail(ct, |ct| mod 128)

for ci in ct_blocks:
    msg = msg || Dec(ci)

if cn is not empty:
    msg = msg || DecPartial(cn)

expected_tag = Finalize(|ad|, |msg|)

if CtEq(tag, expected_tag) is False:
    erase msg
    return "verification failed" error
else:
    return msg
</pre><a href="#section-4.2-10" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-init-function-1">
<section id="section-4.3">
        <h3 id="name-the-init-function-2">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-the-init-function-2" class="section-name selfRef">The Init Function</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-4.3-1">
<pre>
Init(key, nonce)
</pre><a href="#section-4.3-1" class="pilcrow">¶</a>
</div>
<p id="section-4.3-2">The <code>Init</code> function constructs the initial state <code>{S0, ...S5}</code> using the given <code>key</code> and <code>nonce</code>.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">Inputs:<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-4.1">
            <p id="section-4.3-4.1.1"><code>key</code>: the encryption key.<a href="#section-4.3-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-4.2">
            <p id="section-4.3-4.2.1"><code>nonce</code>: the public nonce.<a href="#section-4.3-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.3-5">Defines:<a href="#section-4.3-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-6.1">
            <p id="section-4.3-6.1.1"><code>{S0, ...S5}</code>: the initial state.<a href="#section-4.3-6.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.3-7">Steps:<a href="#section-4.3-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-8">
<pre>
k0, k1 = Split(key, 128)
n0, n1 = Split(nonce, 128)

S0 = k0 ^ n0
S1 = k1 ^ n1
S2 = C1
S3 = C0
S4 = k0 ^ C0
S5 = k1 ^ C1

Repeat(4,
  Update(k0)
  Update(k1)
  Update(k0 ^ n0)
  Update(k1 ^ n1)
)
</pre><a href="#section-4.3-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-update-function-1">
<section id="section-4.4">
        <h3 id="name-the-update-function-2">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-the-update-function-2" class="section-name selfRef">The Update Function</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-4.4-1">
<pre>
Update(M)
</pre><a href="#section-4.4-1" class="pilcrow">¶</a>
</div>
<p id="section-4.4-2">The <code>Update</code> function is the core of the AEGIS-256 algorithm.
It updates the state <code>{S0, ...S5}</code> using a 128-bit value.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<p id="section-4.4-3">Inputs:<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-4.1">
            <p id="section-4.4-4.1.1"><code>msg</code>: the block to be absorbed.<a href="#section-4.4-4.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.4-5">Modifies:<a href="#section-4.4-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-6.1">
            <p id="section-4.4-6.1.1"><code>{S0, ...S5}</code>: the state.<a href="#section-4.4-6.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.4-7">Steps:<a href="#section-4.4-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4-8">
<pre>
S'0 = AESRound(S5, S0 ^ M)
S'1 = AESRound(S0, S1)
S'2 = AESRound(S1, S2)
S'3 = AESRound(S2, S3)
S'4 = AESRound(S3, S4)
S'5 = AESRound(S4, S5)

S0  = S'0
S1  = S'1
S2  = S'2
S3  = S'3
S4  = S'4
S5  = S'5
</pre><a href="#section-4.4-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-absorb-function-1">
<section id="section-4.5">
        <h3 id="name-the-absorb-function-2">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-the-absorb-function-2" class="section-name selfRef">The Absorb Function</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-4.5-1">
<pre>
Absorb(ai)
</pre><a href="#section-4.5-1" class="pilcrow">¶</a>
</div>
<p id="section-4.5-2">The <code>Absorb</code> function absorbs a 128-bit input block <code>ai</code> into the state <code>{S0, ...S5}</code>.<a href="#section-4.5-2" class="pilcrow">¶</a></p>
<p id="section-4.5-3">Inputs:<a href="#section-4.5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5-4.1">
            <p id="section-4.5-4.1.1"><code>ai</code>: the input block.<a href="#section-4.5-4.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.5-5">Steps:<a href="#section-4.5-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5-6">
<pre>
Update(ai)
</pre><a href="#section-4.5-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-enc-function-1">
<section id="section-4.6">
        <h3 id="name-the-enc-function-2">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-the-enc-function-2" class="section-name selfRef">The Enc Function</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-4.6-1">
<pre>
Enc(xi)
</pre><a href="#section-4.6-1" class="pilcrow">¶</a>
</div>
<p id="section-4.6-2">The <code>Enc</code> function encrypts a 128-bit input block <code>xi</code> using the state <code>{S0, ...S5}</code>.<a href="#section-4.6-2" class="pilcrow">¶</a></p>
<p id="section-4.6-3">Inputs:<a href="#section-4.6-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.6-4.1">
            <p id="section-4.6-4.1.1"><code>xi</code>: the input block.<a href="#section-4.6-4.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.6-5">Outputs:<a href="#section-4.6-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.6-6.1">
            <p id="section-4.6-6.1.1"><code>ci</code>: the encrypted input block.<a href="#section-4.6-6.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.6-7">Steps:<a href="#section-4.6-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.6-8">
<pre>
z = S1 ^ S4 ^ S5 ^ (S2 &amp; S3)

Update(xi)

ci = xi ^ z

return ci
</pre><a href="#section-4.6-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-dec-function-1">
<section id="section-4.7">
        <h3 id="name-the-dec-function-2">
<a href="#section-4.7" class="section-number selfRef">4.7. </a><a href="#name-the-dec-function-2" class="section-name selfRef">The Dec Function</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-4.7-1">
<pre>
Dec(ci)
</pre><a href="#section-4.7-1" class="pilcrow">¶</a>
</div>
<p id="section-4.7-2">The <code>Dec</code> function decrypts a 128-bit input block <code>ci</code> using the state <code>{S0, ...S5}</code>.<a href="#section-4.7-2" class="pilcrow">¶</a></p>
<p id="section-4.7-3">Inputs:<a href="#section-4.7-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.7-4.1">
            <p id="section-4.7-4.1.1"><code>ci</code>: the encrypted input block.<a href="#section-4.7-4.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.7-5">Outputs:<a href="#section-4.7-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.7-6.1">
            <p id="section-4.7-6.1.1"><code>xi</code>: the decrypted block.<a href="#section-4.7-6.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.7-7">Steps:<a href="#section-4.7-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.7-8">
<pre>
z = S1 ^ S4 ^ S5 ^ (S2 &amp; S3)

xi = ci ^ z

Update(xi)

return xi
</pre><a href="#section-4.7-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-decpartial-function-1">
<section id="section-4.8">
        <h3 id="name-the-decpartial-function-2">
<a href="#section-4.8" class="section-number selfRef">4.8. </a><a href="#name-the-decpartial-function-2" class="section-name selfRef">The DecPartial Function</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-4.8-1">
<pre>
DecPartial(cn)
</pre><a href="#section-4.8-1" class="pilcrow">¶</a>
</div>
<p id="section-4.8-2">The <code>DecPartial</code> function decrypts the last ciphertext bits <code>cn</code> using the state <code>{S0, ...S5}</code> when they do not fill an entire block.<a href="#section-4.8-2" class="pilcrow">¶</a></p>
<p id="section-4.8-3">Inputs:<a href="#section-4.8-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.8-4.1">
            <p id="section-4.8-4.1.1"><code>cn</code>: the encrypted input.<a href="#section-4.8-4.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.8-5">Outputs:<a href="#section-4.8-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.8-6.1">
            <p id="section-4.8-6.1.1"><code>xn</code>: the decryption of <code>cn</code>.<a href="#section-4.8-6.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.8-7">Steps:<a href="#section-4.8-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.8-8">
<pre>
z = S1 ^ S4 ^ S5 ^ (S2 &amp; S3)

t = ZeroPad(cn, 128)
out = t ^ z

xn = Truncate(out, |cn|)

v = ZeroPad(xn, 128)
Update(v)

return xn
</pre><a href="#section-4.8-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-finalize-function-1">
<section id="section-4.9">
        <h3 id="name-the-finalize-function-2">
<a href="#section-4.9" class="section-number selfRef">4.9. </a><a href="#name-the-finalize-function-2" class="section-name selfRef">The Finalize Function</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-4.9-1">
<pre>
Finalize(ad_len_bits, msg_len_bits)
</pre><a href="#section-4.9-1" class="pilcrow">¶</a>
</div>
<p id="section-4.9-2">The <code>Finalize</code> function computes a 128- or 256-bit tag that authenticates the message and associated data.<a href="#section-4.9-2" class="pilcrow">¶</a></p>
<p id="section-4.9-3">Inputs:<a href="#section-4.9-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.9-4.1">
            <p id="section-4.9-4.1.1"><code>ad_len_bits</code>: the length of the associated data in bits.<a href="#section-4.9-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.9-4.2">
            <p id="section-4.9-4.2.1"><code>msg_len_bits</code>: the length of the message in bits.<a href="#section-4.9-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.9-5">Outputs:<a href="#section-4.9-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.9-6.1">
            <p id="section-4.9-6.1.1"><code>tag</code>: the authentication tag.<a href="#section-4.9-6.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.9-7">Steps:<a href="#section-4.9-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.9-8">
<pre>
t = S3 ^ (LE64(ad_len_bits) || LE64(msg_len_bits))

Repeat(7, Update(t))

if tag_length == 16: # 128 bits
    tag = S0 ^ S1 ^ S2 ^ S3 ^ S4 ^ S5
else:                # 256 bits
    tag = (S0 ^ S1 ^ S2) || (S3 ^ S4 ^ S5)

return tag
</pre><a href="#section-4.9-8" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="parallel-modes">
<section id="section-5">
      <h2 id="name-parallel-modes">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-parallel-modes" class="section-name selfRef">Parallel Modes</a>
      </h2>
<p id="section-5-1">Some CPUs, such as Intel and Intel-compatible CPUs with the VAES extensions, include instructions to efficiently apply the AES round function to a vector of AES blocks.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">AEGIS-128X and AEGIS-256X are optional, specialized modes designed to take advantage of these instructions. They share the same properties as the ciphers they are based on but can be significantly faster on these platforms, even for short messages.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">AEGIS-128X and AEGIS-256X are parallel evaluations of multiple AEGIS-128L and AEGIS-256 instances respectively, with distinct initial states. On CPUs with wide vector registers, different states can be stored in different 128-bit lanes of the same vector register, allowing parallel updates using vector instructions.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">The modes are parameterized by the parallelism degree. With 256-bit registers, 2 parallel operations can be applied to 128-bit AES blocks. With 512-bit registers, the number of instances can be raised to 4.<a href="#section-5-4" class="pilcrow">¶</a></p>
<p id="section-5-5">The state of a parallel mode is represented as a vector of AEGIS-128L or AEGIS-256 states.<a href="#section-5-5" class="pilcrow">¶</a></p>
<div id="additional-conventions-and-definitions">
<section id="section-5.1">
        <h3 id="name-additional-conventions-and-">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-additional-conventions-and-" class="section-name selfRef">Additional Conventions and Definitions</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-5.1-1.1">
            <p id="section-5.1-1.1.1"><code>D</code>: the degree of parallelism.<a href="#section-5.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-1.2">
            <p id="section-5.1-1.2.1"><code>R</code>: the absorption and output rate of the mode. With AEGIS-128X, the rate is <code>256 * D</code> bits. With AEGIS-256X, the rate is <code>128 * D</code> bits.<a href="#section-5.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-1.3">
            <p id="section-5.1-1.3.1"><code>V[j,i]</code>: the <code>j</code>-th AES block of the <code>i</code>-th state. <code>i</code> is in the <code>[0..D)</code> range. For AEGIS-128X, <code>j</code> is in the <code>[0..8)</code> range, while for AEGIS-256, <code>j</code> is in the <code>[0..6)</code> range.<a href="#section-5.1-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-1.4">
            <p id="section-5.1-1.4.1"><code>V'[j,i]</code>: the <code>j</code>-th AES block of the next <code>i</code>-th state.<a href="#section-5.1-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-1.5">
            <p id="section-5.1-1.5.1"><code>ctx[i]</code>: the <code>i</code>-th context separator. This is a 128-bit mask, made of a byte representing the state index, followed by a byte representing the highest index and 112 all-zero bits.<a href="#section-5.1-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-1.6">
            <p id="section-5.1-1.6.1"><code>Byte(x)</code>: the value <code>x</code> encoded as 8 bits.<a href="#section-5.1-1.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="authenticated-encryption-2">
<section id="section-5.2">
        <h3 id="name-authenticated-encryption-3">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-authenticated-encryption-3" class="section-name selfRef">Authenticated Encryption</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-5.2-1">
<pre>
Encrypt(msg, ad, key, nonce)
</pre><a href="#section-5.2-1" class="pilcrow">¶</a>
</div>
<p id="section-5.2-2">The <code>Encrypt</code> function of AEGIS-128X resembles that of AEGIS-128L, and similarly, the <code>Encrypt</code> function of AEGIS-256X mirrors that of AEGIS-256, but processes <code>R</code>-bit input blocks per update.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">Steps:<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-4">
<pre>
Init(key, nonce)

ct = {}

ad_blocks = Split(ZeroPad(ad, R), R)
for ai in ad_blocks:
    Absorb(ai)

msg_blocks = Split(ZeroPad(msg, R), R)
for xi in msg_blocks:
    ct = ct || Enc(xi)

tag = Finalize(|ad|, |msg|)
ct = Truncate(ct, |msg|)

return ct and tag
</pre><a href="#section-5.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="authenticated-decryption-2">
<section id="section-5.3">
        <h3 id="name-authenticated-decryption-3">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-authenticated-decryption-3" class="section-name selfRef">Authenticated Decryption</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-5.3-1">
<pre>
Decrypt(ct, tag, ad, key, nonce)
</pre><a href="#section-5.3-1" class="pilcrow">¶</a>
</div>
<p id="section-5.3-2">The <code>Decrypt</code> function of AEGIS-128X resembles that of AEGIS-128L, and similarly, the <code>Decrypt</code> function of AEGIS-256X mirrors that of AEGIS-256, but processes <code>R</code>-bit input blocks per update.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3-3">Steps:<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-4">
<pre>
Init(key, nonce)

msg = {}

ad_blocks = Split(ZeroPad(ad, R), R)
for ai in ad_blocks:
    Absorb(ai)

ct_blocks = Split(ct, R)
cn = Tail(ct, |ct| mod R)

for ci in ct_blocks:
    msg = msg || Dec(ci)

if cn is not empty:
    msg = msg || DecPartial(cn)

expected_tag = Finalize(|ad|, |msg|)

if CtEq(tag, expected_tag) is False:
    erase msg
    return "verification failed" error
else:
    return msg
</pre><a href="#section-5.3-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="aegis-128x">
<section id="section-5.4">
        <h3 id="name-aegis-128x">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-aegis-128x" class="section-name selfRef">AEGIS-128X</a>
        </h3>
<div id="the-init-function-2">
<section id="section-5.4.1">
          <h4 id="name-the-init-function-3">
<a href="#section-5.4.1" class="section-number selfRef">5.4.1. </a><a href="#name-the-init-function-3" class="section-name selfRef">The Init Function</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-5.4.1-1">
<pre>
Init(key, nonce)
</pre><a href="#section-5.4.1-1" class="pilcrow">¶</a>
</div>
<p id="section-5.4.1-2">The <code>Init</code> function initializes a vector of <code>D</code> AEGIS-128L states with the same <code>key</code> and <code>nonce</code> but a different context <code>ctx[i]</code>. The context is added to the state before every update.<a href="#section-5.4.1-2" class="pilcrow">¶</a></p>
<p id="section-5.4.1-3">Steps:<a href="#section-5.4.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.4.1-4">
<pre>
for i in 0..D:
    V[0,i] = key ^ nonce
    V[1,i] = C1
    V[2,i] = C0
    V[3,i] = C1
    V[4,i] = key ^ nonce
    V[5,i] = key ^ C0
    V[6,i] = key ^ C1
    V[7,i] = key ^ C0

nonce_v = {}
key_v = {}
for i in 0..D:
    nonce_v = nonce_v || nonce
    key_v = key_v || key

for i in 0..D:
    ctx[i] = ZeroPad(Byte(i) || Byte(D - 1), 128)

Repeat(10,
    for i in 0..D:
        V[3,i] = V[3,i] ^ ctx[i]
        V[7,i] = V[7,i] ^ ctx[i]

    Update(nonce_v, key_v)
)
</pre><a href="#section-5.4.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-update-function-2">
<section id="section-5.4.2">
          <h4 id="name-the-update-function-3">
<a href="#section-5.4.2" class="section-number selfRef">5.4.2. </a><a href="#name-the-update-function-3" class="section-name selfRef">The Update Function</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-5.4.2-1">
<pre>
Update(M0, M1)
</pre><a href="#section-5.4.2-1" class="pilcrow">¶</a>
</div>
<p id="section-5.4.2-2">The AEGIS-128X <code>Update</code> function is similar to the AEGIS-128L <code>Update</code> function, but absorbs <code>R</code> (= <code>256 * D</code>) bits at once. <code>M0</code> and <code>M1</code> are <code>128 * D</code> bits instead of 128 bits but are split into 128-bit blocks, each of them updating a different AEGIS-128L state.<a href="#section-5.4.2-2" class="pilcrow">¶</a></p>
<p id="section-5.4.2-3">Steps:<a href="#section-5.4.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.4.2-4">
<pre>
m0 = Split(M0, 128)
m1 = Split(M1, 128)

for i in 0..D:
    V'[0,i] = AESRound(V[7,i], V[0,i] ^ m0[i])
    V'[1,i] = AESRound(V[0,i], V[1,i])
    V'[2,i] = AESRound(V[1,i], V[2,i])
    V'[3,i] = AESRound(V[2,i], V[3,i])
    V'[4,i] = AESRound(V[3,i], V[4,i] ^ m1[i])
    V'[5,i] = AESRound(V[4,i], V[5,i])
    V'[6,i] = AESRound(V[5,i], V[6,i])
    V'[7,i] = AESRound(V[6,i], V[7,i])

    V[0,i]  = V'[0,i]
    V[1,i]  = V'[1,i]
    V[2,i]  = V'[2,i]
    V[3,i]  = V'[3,i]
    V[4,i]  = V'[4,i]
    V[5,i]  = V'[5,i]
    V[6,i]  = V'[6,i]
    V[7,i]  = V'[7,i]
</pre><a href="#section-5.4.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-absorb-function-2">
<section id="section-5.4.3">
          <h4 id="name-the-absorb-function-3">
<a href="#section-5.4.3" class="section-number selfRef">5.4.3. </a><a href="#name-the-absorb-function-3" class="section-name selfRef">The Absorb Function</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-5.4.3-1">
<pre>
Absorb(ai)
</pre><a href="#section-5.4.3-1" class="pilcrow">¶</a>
</div>
<p id="section-5.4.3-2">The <code>Absorb</code> function is similar to the AEGIS-128L <code>Absorb</code> function, but absorbs <code>R</code> bits instead of 256 bits.<a href="#section-5.4.3-2" class="pilcrow">¶</a></p>
<p id="section-5.4.3-3">Steps:<a href="#section-5.4.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.4.3-4">
<pre>
t0, t1 = Split(ai, R)
Update(t0, t1)
</pre><a href="#section-5.4.3-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-enc-function-2">
<section id="section-5.4.4">
          <h4 id="name-the-enc-function-3">
<a href="#section-5.4.4" class="section-number selfRef">5.4.4. </a><a href="#name-the-enc-function-3" class="section-name selfRef">The Enc Function</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-5.4.4-1">
<pre>
Enc(xi)
</pre><a href="#section-5.4.4-1" class="pilcrow">¶</a>
</div>
<p id="section-5.4.4-2">The <code>Enc</code> function is similar to the AEGIS-128L <code>Enc</code> function, but encrypts <code>R</code> bits instead of 256 bits.<a href="#section-5.4.4-2" class="pilcrow">¶</a></p>
<p id="section-5.4.4-3">Steps:<a href="#section-5.4.4-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.4.4-4">
<pre>
z0 = {}
z1 = {}
for i in 0..D:
    z0 = z0 || (V[6,i] ^ V[1,i] ^ (V[2,i] &amp; V[3,i]))
    z1 = z1 || (V[2,i] ^ V[5,i] ^ (V[6,i] &amp; V[7,i]))

t0, t1 = Split(xi, R)
out0 = t0 ^ z0
out1 = t1 ^ z1

Update(t0, t1)
ci = out0 || out1

return ci
</pre><a href="#section-5.4.4-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-dec-function-2">
<section id="section-5.4.5">
          <h4 id="name-the-dec-function-3">
<a href="#section-5.4.5" class="section-number selfRef">5.4.5. </a><a href="#name-the-dec-function-3" class="section-name selfRef">The Dec Function</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-5.4.5-1">
<pre>
Dec(ci)
</pre><a href="#section-5.4.5-1" class="pilcrow">¶</a>
</div>
<p id="section-5.4.5-2">The <code>Dec</code> function is similar to the AEGIS-128L <code>Dec</code> function, but decrypts <code>R</code> bits instead of 256 bits.<a href="#section-5.4.5-2" class="pilcrow">¶</a></p>
<p id="section-5.4.5-3">Steps:<a href="#section-5.4.5-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.4.5-4">
<pre>
z0 = {}
z1 = {}
for i in 0..D:
    z0 = z0 || (V[6,i] ^ V[1,i] ^ (V[2,i] &amp; V[3,i]))
    z1 = z1 || (V[2,i] ^ V[5,i] ^ (V[6,i] &amp; V[7,i]))

t0, t1 = Split(ci, R)
out0 = t0 ^ z0
out1 = t1 ^ z1

Update(out0, out1)
xi = out0 || out1

return xi
</pre><a href="#section-5.4.5-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-decpartial-function-2">
<section id="section-5.4.6">
          <h4 id="name-the-decpartial-function-3">
<a href="#section-5.4.6" class="section-number selfRef">5.4.6. </a><a href="#name-the-decpartial-function-3" class="section-name selfRef">The DecPartial Function</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-5.4.6-1">
<pre>
DecPartial(cn)
</pre><a href="#section-5.4.6-1" class="pilcrow">¶</a>
</div>
<p id="section-5.4.6-2">The <code>DecPartial</code> function is similar to the AEGIS-128L <code>DecPartial</code> function, but decrypts up to <code>R</code> bits instead of 256 bits.<a href="#section-5.4.6-2" class="pilcrow">¶</a></p>
<p id="section-5.4.6-3">Steps:<a href="#section-5.4.6-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.4.6-4">
<pre>
z0 = {}
z1 = {}
for i in 0..D:
    z0 = z0 || (V[6,i] ^ V[1,i] ^ (V[2,i] &amp; V[3,i]))
    z1 = z1 || (V[2,i] ^ V[5,i] ^ (V[6,i] &amp; V[7,i]))

t0, t1 = Split(ZeroPad(cn, R), 128 * D)
out0 = t0 ^ z0
out1 = t1 ^ z1

xn = Truncate(out0 || out1, |cn|)

v0, v1 = Split(ZeroPad(xn, R), 128 * D)
Update(v0, v1)

return xn
</pre><a href="#section-5.4.6-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-finalize-function-2">
<section id="section-5.4.7">
          <h4 id="name-the-finalize-function-3">
<a href="#section-5.4.7" class="section-number selfRef">5.4.7. </a><a href="#name-the-finalize-function-3" class="section-name selfRef">The Finalize Function</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-5.4.7-1">
<pre>
Finalize(ad_len_bits, msg_len_bits)
</pre><a href="#section-5.4.7-1" class="pilcrow">¶</a>
</div>
<p id="section-5.4.7-2">The <code>Finalize</code> function finalizes every AEGIS-128L instance and combines the resulting authentication tags using the bitwise exclusive OR operation.<a href="#section-5.4.7-2" class="pilcrow">¶</a></p>
<p id="section-5.4.7-3">Steps:<a href="#section-5.4.7-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.4.7-4">
<pre>
t = {}
u = LE64(ad_len_bits) || LE64(msg_len_bits)
for i in 0..D:
    t = t || (V[2,i] ^ u)

Repeat(7, Update(t, t))

if tag_length == 16: # 128 bits
    tag = ZeroPad({}, 128)
    for i in 0..D:
        tag = tag ^ V[0,i] ^ V[1,i] ^ V[2,i] ^ V[3,i] ^ V[4,i] ^ V[5,i] ^ V[6,i]

else:                # 256 bits
    tag0 = ZeroPad({}, 128)
    tag1 = ZeroPad({}, 128)
    for i in 0..D:
        tag0 = tag0 ^ V[0,i] ^ V[1,i] ^ V[2,i] ^ V[3,i]
        tag1 = tag1 ^ V[4,i] ^ V[5,i] ^ V[6,i] ^ V[7,i]
    tag = tag0 || tag1

return tag
</pre><a href="#section-5.4.7-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="aegis-256x">
<section id="section-5.5">
        <h3 id="name-aegis-256x">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-aegis-256x" class="section-name selfRef">AEGIS-256X</a>
        </h3>
<div id="the-init-function-3">
<section id="section-5.5.1">
          <h4 id="name-the-init-function-4">
<a href="#section-5.5.1" class="section-number selfRef">5.5.1. </a><a href="#name-the-init-function-4" class="section-name selfRef">The Init Function</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-5.5.1-1">
<pre>
Init(key, nonce)
</pre><a href="#section-5.5.1-1" class="pilcrow">¶</a>
</div>
<p id="section-5.5.1-2">The <code>Init</code> function initializes a vector of <code>D</code> AEGIS-256 states with the same <code>key</code> and <code>nonce</code> but a different context <code>ctx[i]</code>. The context is added to the state before every update.<a href="#section-5.5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.5.1-3">Steps:<a href="#section-5.5.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.5.1-4">
<pre>
k0, k1 = Split(key, 128)
n0, n1 = Split(nonce, 128)

for i in 0..D:
    V[0,i] = k0 ^ n0
    V[1,i] = k1 ^ n1
    V[2,i] = C1
    V[3,i] = C0
    V[4,i] = k0 ^ C0
    V[5,i] = k1 ^ C1

k0_v, k1_v = {}, {}
k0n0_v, k1n1_v = {}, {}
for i in 0..D:
    k0_v = k0_v || k0
    k1_v = k1_v || k1
    k0n0_v = k0n0_v || (k0 ^ n0)
    k1n1_v = k1n1_v || (k1 ^ n1)

for i in 0..D:
    ctx[i] = ZeroPad(Byte(i) || Byte(D - 1), 128)

Repeat(4,
    for i in 0..D:
        V[3,i] = V[3,i] ^ ctx[i]
        V[5,i] = V[5,i] ^ ctx[i]

    Update(k0_v)
    for i in 0..D:
        V[3,i] = V[3,i] ^ ctx[i]
        V[5,i] = V[5,i] ^ ctx[i]

    Update(k1_v)
    for i in 0..D:
        V[3,i] = V[3,i] ^ ctx[i]
        V[5,i] = V[5,i] ^ ctx[i]

    Update(k0n0_v)
    for i in 0..D:
        V[3,i] = V[3,i] ^ ctx[i]
        V[5,i] = V[5,i] ^ ctx[i]

    Update(k1n1_v)
)
</pre><a href="#section-5.5.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-update-function-3">
<section id="section-5.5.2">
          <h4 id="name-the-update-function-4">
<a href="#section-5.5.2" class="section-number selfRef">5.5.2. </a><a href="#name-the-update-function-4" class="section-name selfRef">The Update Function</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-5.5.2-1">
<pre>
Update(M)
</pre><a href="#section-5.5.2-1" class="pilcrow">¶</a>
</div>
<p id="section-5.5.2-2">The AEGIS-256X <code>Update</code> function is similar to the AEGIS-256 <code>Update</code> function, but absorbs <code>R</code> (<code>128 * D</code>) bits at once. <code>M</code> is <code>128 * D</code> bits instead of 128 bits and is split into 128-bit blocks, each of them updating a different AEGIS-256 state.<a href="#section-5.5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.5.2-3">Steps:<a href="#section-5.5.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.5.2-4">
<pre>
m = Split(M, 128)

for i in 0..D:
    V'[0,i] = AESRound(V[5,i], V[0,i] ^ m[i])
    V'[1,i] = AESRound(V[0,i], V[1,i])
    V'[2,i] = AESRound(V[1,i], V[2,i])
    V'[3,i] = AESRound(V[2,i], V[3,i])
    V'[4,i] = AESRound(V[3,i], V[4,i])
    V'[5,i] = AESRound(V[4,i], V[5,i])

    V[0,i]  = V'[0,i]
    V[1,i]  = V'[1,i]
    V[2,i]  = V'[2,i]
    V[3,i]  = V'[3,i]
    V[4,i]  = V'[4,i]
    V[5,i]  = V'[5,i]
</pre><a href="#section-5.5.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-absorb-function-3">
<section id="section-5.5.3">
          <h4 id="name-the-absorb-function-4">
<a href="#section-5.5.3" class="section-number selfRef">5.5.3. </a><a href="#name-the-absorb-function-4" class="section-name selfRef">The Absorb Function</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-5.5.3-1">
<pre>
Absorb(ai)
</pre><a href="#section-5.5.3-1" class="pilcrow">¶</a>
</div>
<p id="section-5.5.3-2">The <code>Absorb</code> function is similar to the AEGIS-256 <code>Absorb</code> function, but absorbs <code>R</code> bits instead of 128 bits.<a href="#section-5.5.3-2" class="pilcrow">¶</a></p>
<p id="section-5.5.3-3">Steps:<a href="#section-5.5.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.5.3-4">
<pre>
Update(ai)
</pre><a href="#section-5.5.3-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-enc-function-3">
<section id="section-5.5.4">
          <h4 id="name-the-enc-function-4">
<a href="#section-5.5.4" class="section-number selfRef">5.5.4. </a><a href="#name-the-enc-function-4" class="section-name selfRef">The Enc Function</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-5.5.4-1">
<pre>
Enc(xi)
</pre><a href="#section-5.5.4-1" class="pilcrow">¶</a>
</div>
<p id="section-5.5.4-2">The <code>Enc</code> function is similar to the AEGIS-256 <code>Enc</code> function, but encrypts <code>R</code> bits instead of 128 bits.<a href="#section-5.5.4-2" class="pilcrow">¶</a></p>
<p id="section-5.5.4-3">Steps:<a href="#section-5.5.4-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.5.4-4">
<pre>
z = {}
for i in 0..D:
    z = z || (V[1,i] ^ V[4,i] ^ V[5,i] ^ (V[2,i] &amp; V[3,i]))

Update(xi)

ci = xi ^ z

return ci
</pre><a href="#section-5.5.4-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-dec-function-3">
<section id="section-5.5.5">
          <h4 id="name-the-dec-function-4">
<a href="#section-5.5.5" class="section-number selfRef">5.5.5. </a><a href="#name-the-dec-function-4" class="section-name selfRef">The Dec Function</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-5.5.5-1">
<pre>
Dec(ci)
</pre><a href="#section-5.5.5-1" class="pilcrow">¶</a>
</div>
<p id="section-5.5.5-2">The <code>Dec</code> function is similar to the AEGIS-256 <code>Dec</code> function, but decrypts <code>R</code> bits instead of 128 bits.<a href="#section-5.5.5-2" class="pilcrow">¶</a></p>
<p id="section-5.5.5-3">Steps:<a href="#section-5.5.5-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.5.5-4">
<pre>
z = {}
for i in 0..D:
    z = z || (V[1,i] ^ V[4,i] ^ V[5,i] ^ (V[2,i] &amp; V[3,i]))

xi = ci ^ z

Update(xi)

return xi
</pre><a href="#section-5.5.5-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-decpartial-function-3">
<section id="section-5.5.6">
          <h4 id="name-the-decpartial-function-4">
<a href="#section-5.5.6" class="section-number selfRef">5.5.6. </a><a href="#name-the-decpartial-function-4" class="section-name selfRef">The DecPartial Function</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-5.5.6-1">
<pre>
DecPartial(cn)
</pre><a href="#section-5.5.6-1" class="pilcrow">¶</a>
</div>
<p id="section-5.5.6-2">The <code>DecPartial</code> function is similar to the AEGIS-256 <code>DecPartial</code> function, but decrypts up to <code>R</code> bits instead of 128 bits.<a href="#section-5.5.6-2" class="pilcrow">¶</a></p>
<p id="section-5.5.6-3">Steps:<a href="#section-5.5.6-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.5.6-4">
<pre>
z = {}
for i in 0..D:
    z = z || (V[1,i] ^ V[4,i] ^ V[5,i] ^ (V[2,i] &amp; V[3,i]))

t = ZeroPad(cn, R)
out = t ^ z

xn = Truncate(out, |cn|)

v = ZeroPad(xn, 128 * D)
Update(v)

return xn
</pre><a href="#section-5.5.6-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-finalize-function-3">
<section id="section-5.5.7">
          <h4 id="name-the-finalize-function-4">
<a href="#section-5.5.7" class="section-number selfRef">5.5.7. </a><a href="#name-the-finalize-function-4" class="section-name selfRef">The Finalize Function</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-5.5.7-1">
<pre>
Finalize(ad_len_bits, msg_len_bits)
</pre><a href="#section-5.5.7-1" class="pilcrow">¶</a>
</div>
<p id="section-5.5.7-2">The <code>Finalize</code> function finalizes every AEGIS-256 instance and combines the resulting authentication tags using the bitwise exclusive OR operation.<a href="#section-5.5.7-2" class="pilcrow">¶</a></p>
<p id="section-5.5.7-3">Steps:<a href="#section-5.5.7-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.5.7-4">
<pre>
t = {}
u = LE64(ad_len_bits) || LE64(msg_len_bits)
for i in 0..D:
    t = t || (V[3,i] ^ u)

Repeat(7, Update(t))

if tag_length == 16: # 128 bits
    tag = ZeroPad({}, 128)
    for i in 0..D:
        tag = tag ^ V[0,i] ^ V[1,i] ^ V[2,i] ^ V[3,i] ^ V[4,i] ^ V[5,i]

else:                # 256 bits
    tag0 = ZeroPad({}, 128)
    tag1 = ZeroPad({}, 128)
    for i in 0..D:
        tag0 = tag0 ^ V[0,i] ^ V[1,i] ^ V[2,i]
        tag1 = tag1 ^ V[3,i] ^ V[4,i] ^ V[5,i]
    tag = tag0 || tag1

return tag
</pre><a href="#section-5.5.7-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="implementation-considerations">
<section id="section-5.6">
        <h3 id="name-implementation-consideratio">
<a href="#section-5.6" class="section-number selfRef">5.6. </a><a href="#name-implementation-consideratio" class="section-name selfRef">Implementation Considerations</a>
        </h3>
<p id="section-5.6-1">AEGIS-128X and AEGIS-256X with a degree of <code>1</code> are identical to AEGIS-128L and AEGIS-256. This property can be used to reduce the size of a generic implementation.<a href="#section-5.6-1" class="pilcrow">¶</a></p>
<p id="section-5.6-2">In AEGIS-128X, <code>V</code> can be represented as eight 256-bit registers (when <code>D = 2</code>) or eight 512-bit registers (when <code>D = 4</code>). In AEGIS-256X, <code>V</code> can be represented as six 256-bit registers (when <code>D = 2</code>) or six 512-bit registers (when <code>D = 4</code>). With this representation, loops over <code>0..D</code> in the above pseudocode can be replaced by vector instructions.<a href="#section-5.6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="operational-considerations">
<section id="section-5.7">
        <h3 id="name-operational-considerations">
<a href="#section-5.7" class="section-number selfRef">5.7. </a><a href="#name-operational-considerations" class="section-name selfRef">Operational Considerations</a>
        </h3>
<p id="section-5.7-1">The AEGIS parallel modes are specialized and can only improve performance on specific CPUs.<a href="#section-5.7-1" class="pilcrow">¶</a></p>
<p id="section-5.7-2">The degrees of parallelism implementations are encouraged to support are <code>2</code> (for CPUs with 256-bit registers) and <code>4</code> (for CPUs with 512-bit registers). The resulting algorithms are called <code>AEGIS-128X2</code>, <code>AEGIS-128X4</code>, <code>AEGIS-256X2</code>, and <code>AEGIS-256X4</code>.<a href="#section-5.7-2" class="pilcrow">¶</a></p>
<p id="section-5.7-3">The following table summarizes how many bits are processed in parallel (rate), the memory requirements (state size), and the minimum vector register sizes a CPU should support for optimal performance.<a href="#section-5.7-3" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Algorithm</th>
              <th class="text-right" rowspan="1" colspan="1">Rate (bits)</th>
              <th class="text-center" rowspan="1" colspan="1">Optimal Register Size</th>
              <th class="text-right" rowspan="1" colspan="1">State Size (bits)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">AEGIS-128L</td>
              <td class="text-right" rowspan="1" colspan="1">256</td>
              <td class="text-center" rowspan="1" colspan="1">128 bits</td>
              <td class="text-right" rowspan="1" colspan="1">1024</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">AEGIS-128X2</td>
              <td class="text-right" rowspan="1" colspan="1">512</td>
              <td class="text-center" rowspan="1" colspan="1">256 bits</td>
              <td class="text-right" rowspan="1" colspan="1">2048</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">AEGIS-128X4</td>
              <td class="text-right" rowspan="1" colspan="1">1024</td>
              <td class="text-center" rowspan="1" colspan="1">512 bits</td>
              <td class="text-right" rowspan="1" colspan="1">4096</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">AEGIS-256</td>
              <td class="text-right" rowspan="1" colspan="1">128</td>
              <td class="text-center" rowspan="1" colspan="1">128 bits</td>
              <td class="text-right" rowspan="1" colspan="1">768</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">AEGIS-256X2</td>
              <td class="text-right" rowspan="1" colspan="1">256</td>
              <td class="text-center" rowspan="1" colspan="1">256 bits</td>
              <td class="text-right" rowspan="1" colspan="1">1536</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">AEGIS-256X4</td>
              <td class="text-right" rowspan="1" colspan="1">512</td>
              <td class="text-center" rowspan="1" colspan="1">512 bits</td>
              <td class="text-right" rowspan="1" colspan="1">3072</td>
            </tr>
          </tbody>
        </table>
<p id="section-5.7-5">Note that architectures with smaller vector registers but with many registers and large pipelines may still benefit from the parallel modes.<a href="#section-5.7-5" class="pilcrow">¶</a></p>
<p id="section-5.7-6">Protocols <span class="bcp14">SHOULD</span> opt for a parallel mode only when all the involved parties agree on a specific variant. AEGIS-128L and AEGIS-256 <span class="bcp14">SHOULD</span> remain the default choices.<a href="#section-5.7-6" class="pilcrow">¶</a></p>
<p id="section-5.7-7">Implementations <span class="bcp14">MAY</span> choose not to include the parallel AEGIS modes.<a href="#section-5.7-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="encoding-ct-tag-tuples">
<section id="section-6">
      <h2 id="name-encoding-ct-tag-tuples">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-encoding-ct-tag-tuples" class="section-name selfRef">Encoding (ct, tag) Tuples</a>
      </h2>
<p id="section-6-1">Applications <span class="bcp14">MAY</span> keep the ciphertext and the authentication tag in distinct structures or encode both as a single string.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">In the latter case, the tag <span class="bcp14">MUST</span> immediately follow the ciphertext:<a href="#section-6-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6-3">
<pre>
combined_ct = ct || tag
</pre><a href="#section-6-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="aegis-as-a-stream-cipher">
<section id="section-7">
      <h2 id="name-aegis-as-a-stream-cipher">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-aegis-as-a-stream-cipher" class="section-name selfRef">AEGIS as a Stream Cipher</a>
      </h2>
<p id="section-7-1">All AEGIS variants can also be used as stream ciphers.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7-2">
<pre>
Stream(len, key, nonce)
</pre><a href="#section-7-2" class="pilcrow">¶</a>
</div>
<p id="section-7-3">The <code>Stream</code> function expands a key and an optional nonce into a variable-length, secure keystream.<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">Inputs:<a href="#section-7-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-5.1">
          <p id="section-7-5.1.1"><code>len</code>: the length of the keystream to generate in bits.<a href="#section-7-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-5.2">
          <p id="section-7-5.2.1"><code>key</code>: the AEGIS key.<a href="#section-7-5.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-5.3">
          <p id="section-7-5.3.1"><code>nonce</code>: the nonce. If unspecified, it is set to <code>N_MAX</code> zero bytes.<a href="#section-7-5.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-7-6">Outputs:<a href="#section-7-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-7.1">
          <p id="section-7-7.1.1"><code>stream</code>: the keystream.<a href="#section-7-7.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-7-8">Steps:<a href="#section-7-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7-9">
<pre>
stream, tag = Encrypt(ZeroPad({}, len), {}, key, nonce)

return stream
</pre><a href="#section-7-9" class="pilcrow">¶</a>
</div>
<p id="section-7-10">This is equivalent to encrypting a <code>len</code> all-zero bits message without associated data, and discarding the authentication tag.<a href="#section-7-10" class="pilcrow">¶</a></p>
<p id="section-7-11">Instead of relying on the generic <code>Encrypt</code> function, implementations can skip the finalization step.<a href="#section-7-11" class="pilcrow">¶</a></p>
<p id="section-7-12">After initialization, the <code>Update</code> function is called with constant parameters, allowing further optimizations.<a href="#section-7-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="implementation-status">
<section id="section-8">
      <h2 id="name-implementation-status">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-implementation-status" class="section-name selfRef">Implementation Status</a>
      </h2>
<p id="section-8-1"><em>This note is to be removed before publishing as an RFC.</em><a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">Multiple implementations of the schemes described in this document have been developed and verified for interoperability.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">A comprehensive list of known implementations and integrations can be found at <span><a href="https://github.com/cfrg/draft-irtf-cfrg-aegis-aead">https://github.com/cfrg/draft-irtf-cfrg-aegis-aead</a></span>, which includes reference implementations closely aligned with the pseudocode provided in this document.<a href="#section-8-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-9">
      <h2 id="name-security-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="usage-guidelines">
<section id="section-9.1">
        <h3 id="name-usage-guidelines">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-usage-guidelines" class="section-name selfRef">Usage Guidelines</a>
        </h3>
<div id="key-and-nonce-selection">
<section id="section-9.1.1">
          <h4 id="name-key-and-nonce-selection">
<a href="#section-9.1.1" class="section-number selfRef">9.1.1. </a><a href="#name-key-and-nonce-selection" class="section-name selfRef">Key and Nonce Selection</a>
          </h4>
<p id="section-9.1.1-1">All AEGIS variants <span class="bcp14">MUST</span> be used in a nonce-respecting setting: for a given <code>key</code>, a <code>nonce</code> <span class="bcp14">MUST</span> only be used once, even with different <code>tag</code> lengths. Failure to do so would immediately reveal the bitwise difference between two messages.<a href="#section-9.1.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1.1-2">Every key <span class="bcp14">MUST</span> be randomly chosen from a uniform distribution.<a href="#section-9.1.1-2" class="pilcrow">¶</a></p>
<p id="section-9.1.1-3">The nonce <span class="bcp14">MAY</span> be public or predictable. It can be a counter, the output of a permutation, or a generator with a long period.<a href="#section-9.1.1-3" class="pilcrow">¶</a></p>
<p id="section-9.1.1-4">With AEGIS-128L and AEGIS-128X, random nonces can safely encrypt up to 2<sup>48</sup> messages using the same key with negligible (~ 2<sup>-33</sup>, to align with NIST guidelines) collision probability.<a href="#section-9.1.1-4" class="pilcrow">¶</a></p>
<p id="section-9.1.1-5">With AEGIS-256 and AEGIS-256X, random nonces can be used with no practical limits.<a href="#section-9.1.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-commitment">
<section id="section-9.1.2">
          <h4 id="name-key-commitment">
<a href="#section-9.1.2" class="section-number selfRef">9.1.2. </a><a href="#name-key-commitment" class="section-name selfRef">Key Commitment</a>
          </h4>
<p id="section-9.1.2-1">An authentication tag may verify under multiple keys, nonces, or associated data, but AEGIS is assumed to be key committing in the receiver-binding game, preventing common attacks when used with low-entropy keys such as passwords. Finding distinct keys and/or nonces that successfully verify the same <code>(ad, ct, tag)</code> tuple is expected to require ~2<sup>64</sup> attempts with a 128-bit authentication tag and ~2<sup>128</sup> attempts with a 256-bit tag.<a href="#section-9.1.2-1" class="pilcrow">¶</a></p>
<p id="section-9.1.2-2">AEGIS is fully committing in the restricted setting where an adversary cannot control the associated data. As shown in <span>[<a href="#IR23" class="cite xref">IR23</a>]</span>, with the ability to alter the associated data, it is possible to efficiently find multiple keys that will verify the same authenticated ciphertext.<a href="#section-9.1.2-2" class="pilcrow">¶</a></p>
<p id="section-9.1.2-3">Protocols mandating a fully committing scheme without that restriction can provide the associated data as input to a cryptographic hash function and use the output as the <code>ad</code> parameter of the <code>Encrypt</code> and <code>Decrypt</code> functions. The selected hash function must ensure a minimum of 128-bit preimage resistance. An instance of such a function is SHA-256 <span>[<a href="#RFC6234" class="cite xref">RFC6234</a>]</span>.<a href="#section-9.1.2-3" class="pilcrow">¶</a></p>
<p id="section-9.1.2-4">Alternatively, the associated data can be fed into a collision-resistant KDF, such as HKDF <span>[<a href="#RFC5869" class="cite xref">RFC5869</a>]</span>, via the <code>info</code> input to derive the <code>key</code> parameter. The <code>ad</code> parameter can then be left empty. Note that the <code>salt</code> input <span class="bcp14">MUST NOT</span> be used since large salts get hashed, which affects commitment. Furthermore, this requires values concatenated to form the <code>info</code> input to be unambiguously encoded, like by appending their lengths.<a href="#section-9.1.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="multi-user-security">
<section id="section-9.1.3">
          <h4 id="name-multi-user-security">
<a href="#section-9.1.3" class="section-number selfRef">9.1.3. </a><a href="#name-multi-user-security" class="section-name selfRef">Multi-User Security</a>
          </h4>
<p id="section-9.1.3-1">AEGIS nonces match the size of the key. AEGIS-128L and AEGIS-128X feature 128-bit nonces, offering an extra 32 bits compared to the commonly used AEADs in IETF protocols. The AEGIS-256 and AEGIS-256X variants provide even larger nonces. With 192 random bits, 64 bits remain available to optionally encode additional information.<a href="#section-9.1.3-1" class="pilcrow">¶</a></p>
<p id="section-9.1.3-2">In all these variants, unused nonce bits can encode a key identifier, enhancing multi-user security. If every key has a unique identifier, multi-target attacks don’t provide any advantage over single-target attacks.<a href="#section-9.1.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="other-uses-of-aegis">
<section id="section-9.1.4">
          <h4 id="name-other-uses-of-aegis">
<a href="#section-9.1.4" class="section-number selfRef">9.1.4. </a><a href="#name-other-uses-of-aegis" class="section-name selfRef">Other Uses of AEGIS</a>
          </h4>
<p id="section-9.1.4-1">All variants can be used solely for authentication by calling the <code>Encrypt()</code> function with the message as the <code>ad</code> and leaving <code>msg</code> empty, resulting in just a tag. However, they <span class="bcp14">MUST NOT</span> be used as a hash function; if the key is known, inputs generating state collisions can easily be crafted. Similarly, as opposed to hash-based MACs, tags <span class="bcp14">MUST NOT</span> be used for key derivation as there is no proof they are uniformly random.<a href="#section-9.1.4-1" class="pilcrow">¶</a></p>
<p id="section-9.1.4-2">Reusing a nonce is acceptable with the AEGIS-128L and AEGIS-256 variants when used exclusively for authentication. However, nonces <span class="bcp14">MUST NOT</span> be reused with the parallel variants (AEGIS-128X and AEGIS-256X) to ensure security against forgery.<a href="#section-9.1.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="implementation-security">
<section id="section-9.2">
        <h3 id="name-implementation-security">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-implementation-security" class="section-name selfRef">Implementation Security</a>
        </h3>
<p id="section-9.2-1">If tag verification fails, the unverified plaintext and the computed message authentication tag <span class="bcp14">MUST NOT</span> be released. As shown in <span>[<a href="#VV18" class="cite xref">VV18</a>]</span>, even a partial leak of the plaintext without verification would facilitate chosen ciphertext attacks.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2">The security of AEGIS against timing and physical attacks is limited by the implementation of the underlying <code>AESRound()</code> function. Failure to implement <code>AESRound()</code> in a fashion safe against timing and physical attacks, such as differential power analysis, timing analysis, or fault injection attacks, may lead to leakage of secret key material or state information. The exact mitigations required for timing and physical attacks also depend on the threat model in question.<a href="#section-9.2-2" class="pilcrow">¶</a></p>
<p id="section-9.2-3">Regardless of the variant, the <code>key</code> and <code>nonce</code> are only required by the <code>Init</code> function; other functions only depend on the resulting state. Therefore, implementations can overwrite ephemeral keys with zeros right after the last <code>Update</code> call of the initialization function.<a href="#section-9.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-guarantees">
<section id="section-9.3">
        <h3 id="name-security-guarantees">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-security-guarantees" class="section-name selfRef">Security Guarantees</a>
        </h3>
<p id="section-9.3-1">AEGIS-256 offers 256-bit message security against plaintext and state recovery, whereas AEGIS-128L offers 128-bit security.<a href="#section-9.3-1" class="pilcrow">¶</a></p>
<p id="section-9.3-2">Under the assumption that the secret key is unknown to the attacker, all AEGIS variants offer at least 128-bit security against forgery attacks.<a href="#section-9.3-2" class="pilcrow">¶</a></p>
<p id="section-9.3-3">Encrypting the same message with the same key and nonce but different associated data generates distinct ciphertexts that do not reveal any additional information about the message.
However, <code>(key, nonce)</code> pairs <span class="bcp14">MUST NOT</span> be reused, even if the associated data differs.<a href="#section-9.3-3" class="pilcrow">¶</a></p>
<p id="section-9.3-4">AEGIS has been shown to have reforgeability resilience in <span>[<a href="#FLLW17" class="cite xref">FLLW17</a>]</span>. Without the ability to set the associated data, a successful forgery does not increase the probability of subsequent forgeries.<a href="#section-9.3-4" class="pilcrow">¶</a></p>
<p id="section-9.3-5">AEGIS-128X and AEGIS-256X share the same security properties and requirements as AEGIS-128L and AEGIS-256 respectively. In particular, the security level and usage limits remain the same <span>[<a href="#D23" class="cite xref">D23</a>]</span>.<a href="#section-9.3-5" class="pilcrow">¶</a></p>
<p id="section-9.3-6">AEGIS is considered secure against guess-and-determine attacks aimed at recovering the state from observed ciphertexts.<a href="#section-9.3-6" class="pilcrow">¶</a></p>
<p id="section-9.3-7">This resilience extends to quantum adversaries operating within the Q1 model, where the attacker has access to a quantum computer but is restricted to classical (non-quantum) communications with the systems under attack. In this model, quantum attacks offer no practical advantage in decrypting previously recorded ciphertexts or in recovering the encryption key.<a href="#section-9.3-7" class="pilcrow">¶</a></p>
<p id="section-9.3-8">This document extends the original specification by introducing optional support for 256-bit authentication tags, which are constructed similarly to the 128-bit tags.
As shown in <span>[<a href="#SSI24" class="cite xref">SSI24</a>]</span>, with 256-bit tags, all AEGIS variants achieve more than 128-bit security against forgery by differential attacks.<a href="#section-9.3-8" class="pilcrow">¶</a></p>
<p id="section-9.3-9">Security analyses of AEGIS can be found in <span>[<a href="#AEGIS" class="cite xref">AEGIS</a>]</span>, <span>[<a href="#M14" class="cite xref">M14</a>]</span>, <span>[<a href="#FLLW17" class="cite xref">FLLW17</a>]</span>, <span>[<a href="#ENP19" class="cite xref">ENP19</a>]</span>, <span>[<a href="#LIMS21" class="cite xref">LIMS21</a>]</span>, <span>[<a href="#JLD21" class="cite xref">JLD21</a>]</span>, <span>[<a href="#STSI23" class="cite xref">STSI23</a>]</span>, <span>[<a href="#IR23" class="cite xref">IR23</a>]</span>, <span>[<a href="#BS23" class="cite xref">BS23</a>]</span>, <span>[<a href="#AIKRS24" class="cite xref">AIKRS24</a>]</span>, and <span>[<a href="#SSI24" class="cite xref">SSI24</a>]</span>.<a href="#section-9.3-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-10-1">IANA has assigned the following identifiers in the AEAD Algorithms Registry:<a href="#section-10-1" class="pilcrow">¶</a></p>
<span id="name-aegis-entries-in-the-aead-a"></span><table class="center" id="table-2">
        <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-aegis-entries-in-the-aead-a" class="selfRef">AEGIS entries in the AEAD Algorithms Registry</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Algorithm Name</th>
            <th class="text-left" rowspan="1" colspan="1">ID</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <code>AEAD_AEGIS128L</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>32</code>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <code>AEAD_AEGIS256</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>33</code>
</td>
          </tr>
        </tbody>
      </table>
<p id="section-10-3">IANA is requested to update the references of these entries to refer to the final version of this document.<a href="#section-10-3" class="pilcrow">¶</a></p>
<p id="section-10-4">IANA is also requested to register the following identifiers in the AEAD Algorithms Registry:<a href="#section-10-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10-5.1">
          <p id="section-10-5.1.1"><code>AEAD_AEGIS128X2</code><a href="#section-10-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-10-5.2">
          <p id="section-10-5.2.1"><code>AEAD_AEGIS128X4</code><a href="#section-10-5.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-10-5.3">
          <p id="section-10-5.3.1"><code>AEAD_AEGIS256X2</code><a href="#section-10-5.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-10-5.4">
          <p id="section-10-5.4.1"><code>AEAD_AEGIS256X4</code><a href="#section-10-5.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="sec-combined-references">
<section id="section-11">
      <h2 id="name-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-11.1">
        <h3 id="name-normative-references">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="FIPS-AES">[FIPS-AES]</dt>
        <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"Advanced encryption standard (AES)"</span>, <span class="seriesInfo">NIST Federal Information Processing Standards Publications 197</span>, <span class="seriesInfo">DOI 10.6028/NIST.FIPS.197</span>, <time datetime="2001-11" class="refDate">November 2001</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.197.pdf">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.197.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5116">[RFC5116]</dt>
        <dd>
<span class="refAuthor">McGrew, D.</span>, <span class="refTitle">"An Interface and Algorithms for Authenticated Encryption"</span>, <span class="seriesInfo">RFC 5116</span>, <span class="seriesInfo">DOI 10.17487/RFC5116</span>, <time datetime="2008-01" class="refDate">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5116">https://www.rfc-editor.org/rfc/rfc5116</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5869">[RFC5869]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span> and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"HMAC-based Extract-and-Expand Key Derivation Function (HKDF)"</span>, <span class="seriesInfo">RFC 5869</span>, <span class="seriesInfo">DOI 10.17487/RFC5869</span>, <time datetime="2010-05" class="refDate">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5869">https://www.rfc-editor.org/rfc/rfc5869</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6234">[RFC6234]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span> and <span class="refAuthor">T. Hansen</span>, <span class="refTitle">"US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)"</span>, <span class="seriesInfo">RFC 6234</span>, <span class="seriesInfo">DOI 10.17487/RFC6234</span>, <time datetime="2011-05" class="refDate">May 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6234">https://www.rfc-editor.org/rfc/rfc6234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-11.2">
        <h3 id="name-informative-references">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="AEGIS">[AEGIS]</dt>
        <dd>
<span class="refAuthor">Wu, H.</span> and <span class="refAuthor">B. Preneel</span>, <span class="refTitle">"AEGIS: A Fast Authenticated Encryption Algorithm (v1.1)"</span>, <time datetime="2016" class="refDate">2016</time>, <span>&lt;<a href="https://competitions.cr.yp.to/round3/aegisv11.pdf">https://competitions.cr.yp.to/round3/aegisv11.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="AIKRS24">[AIKRS24]</dt>
        <dd>
<span class="refAuthor">Anand, R.</span>, <span class="refAuthor">Isobe, T.</span>, <span class="refAuthor">Kundu, A. K.</span>, <span class="refAuthor">Rahman, M.</span>, and <span class="refAuthor">S. Suryawanshi</span>, <span class="refTitle">"Differential fault attack on AES-based encryption schemes: application to B5G/6G ciphers—Rocca, Rocca-S and AEGIS"</span>, <span class="refContent">Journal of Cryptographic Engineering, 2024</span>, <span class="seriesInfo">DOI 10.1007/s13389-024-00360-6</span>, <time datetime="2024" class="refDate">2024</time>, <span>&lt;<a href="https://doi.org/10.1007/s13389-024-00360-6">https://doi.org/10.1007/s13389-024-00360-6</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="BS23">[BS23]</dt>
        <dd>
<span class="refAuthor">Bonnetain, X.</span> and <span class="refAuthor">A. Schrottenloher</span>, <span class="refTitle">"Single-query Quantum Hidden Shift Attacks"</span>, <span class="refContent">Cryptology ePrint Archive, Paper 2023/1306</span>, <time datetime="2023" class="refDate">2023</time>, <span>&lt;<a href="https://eprint.iacr.org/2023/1306">https://eprint.iacr.org/2023/1306</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="D23">[D23]</dt>
        <dd>
<span class="refAuthor">Denis, F.</span>, <span class="refTitle">"Adding more parallelism to the AEGIS authenticated encryption algorithms"</span>, <span class="refContent">Cryptology ePrint Archive, Paper 2023/523</span>, <time datetime="2023" class="refDate">2023</time>, <span>&lt;<a href="https://eprint.iacr.org/2023/523">https://eprint.iacr.org/2023/523</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ENP19">[ENP19]</dt>
        <dd>
<span class="refAuthor">Eichlseder, M.</span>, <span class="refAuthor">Nageler, M.</span>, and <span class="refAuthor">R. Primas</span>, <span class="refTitle">"Analyzing the Linear Keystream Biases in AEGIS"</span>, <span class="refContent">IACR Transactions on Symmetric Cryptology, 2019(4), pp. 348–368</span>, <span class="seriesInfo">DOI 10.13154/tosc.v2019.i4.348-368</span>, <time datetime="2020" class="refDate">2020</time>, <span>&lt;<a href="https://doi.org/10.13154/tosc.v2019.i4.348-368">https://doi.org/10.13154/tosc.v2019.i4.348-368</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FLLW17">[FLLW17]</dt>
        <dd>
<span class="refAuthor">Forler, C.</span>, <span class="refAuthor">List, E.</span>, <span class="refAuthor">Lucks, S.</span>, and <span class="refAuthor">J. Wenzel</span>, <span class="refTitle">"Reforgeability of Authenticated Encryption Schemes"</span>, <span class="refContent">Cryptology ePrint Archive, Paper 2017/332</span>, <time datetime="2017" class="refDate">2017</time>, <span>&lt;<a href="https://eprint.iacr.org/2017/332">https://eprint.iacr.org/2017/332</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IR23">[IR23]</dt>
        <dd>
<span class="refAuthor">Isobe, T.</span> and <span class="refAuthor">M. Rahman</span>, <span class="refTitle">"Key Committing Security Analysis of AEGIS"</span>, <span class="refContent">Cryptology ePrint Archive, Paper 2023/1495</span>, <time datetime="2023" class="refDate">2023</time>, <span>&lt;<a href="https://eprint.iacr.org/2023/1495">https://eprint.iacr.org/2023/1495</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="JLD21">[JLD21]</dt>
        <dd>
<span class="refAuthor">Jiao, L.</span>, <span class="refAuthor">Li, Y.</span>, and <span class="refAuthor">S. Du</span>, <span class="refTitle">"Guess-and-Determine Attacks on AEGIS"</span>, <span class="refContent">The Computer Journal, vol 65, 2022(8), pp. 2221–2230</span>, <span class="seriesInfo">DOI 10.1093/comjnl/bxab059</span>, <time datetime="2021" class="refDate">2021</time>, <span>&lt;<a href="https://doi.org/10.1093/comjnl/bxab059">https://doi.org/10.1093/comjnl/bxab059</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="LGR21">[LGR21]</dt>
        <dd>
<span class="refAuthor">Len, J.</span>, <span class="refAuthor">Grubbs, P.</span>, and <span class="refAuthor">T. Ristenpart</span>, <span class="refTitle">"Partitioning Oracle Attacks"</span>, <span class="refContent">30th USENIX Security Symposium (USENIX Security 21), pp. 195–212</span>, <time datetime="2021" class="refDate">2021</time>, <span>&lt;<a href="https://www.usenix.org/conference/usenixsecurity21/presentation/len">https://www.usenix.org/conference/usenixsecurity21/presentation/len</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="LIMS21">[LIMS21]</dt>
        <dd>
<span class="refAuthor">Liu, F.</span>, <span class="refAuthor">Isobe, T.</span>, <span class="refAuthor">Meier, W.</span>, and <span class="refAuthor">K. Sakamoto</span>, <span class="refTitle">"Weak Keys in Reduced AEGIS and Tiaoxin"</span>, <span class="refContent">IACR Transactions on Symmetric Cryptology, 2021(2), pp. 104–139</span>, <span class="seriesInfo">DOI 10.46586/tosc.v2021.i2.104-139</span>, <time datetime="2021" class="refDate">2021</time>, <span>&lt;<a href="https://doi.org/10.46586/tosc.v2021.i2.104-139">https://doi.org/10.46586/tosc.v2021.i2.104-139</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="M14">[M14]</dt>
        <dd>
<span class="refAuthor">Minaud, B.</span>, <span class="refTitle">"Linear Biases in AEGIS Keystream"</span>, <span class="refContent">Selected Areas in Cryptography. SAC 2014. Lecture Notes in Computer Science, vol 8781, pp. 290–305</span>, <span class="seriesInfo">DOI 10.1007/978-3-319-13051-4_18</span>, <time datetime="2014" class="refDate">2014</time>, <span>&lt;<a href="https://doi.org/10.1007/978-3-319-13051-4_18">https://doi.org/10.1007/978-3-319-13051-4_18</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SSI24">[SSI24]</dt>
        <dd>
<span class="refAuthor">Shiraya, T.</span>, <span class="refAuthor">Sakamoto, K.</span>, and <span class="refAuthor">T. Isobe</span>, <span class="refTitle">"Bit-Wise Analysis for Forgery Attacks on AES-Based AEAD Schemes"</span>, <span class="refContent">Advances in Information and Computer Security. IWSEC 2024. Lecture Notes in Computer Science, vol 14977</span>, <span class="seriesInfo">DOI 10.1007/978-981-97-7737-2_1</span>, <time datetime="2024" class="refDate">2024</time>, <span>&lt;<a href="https://doi.org/10.1007/978-981-97-7737-2_1">https://doi.org/10.1007/978-981-97-7737-2_1</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="STSI23">[STSI23]</dt>
        <dd>
<span class="refAuthor">Shiraya, T.</span>, <span class="refAuthor">Takeuchi, N.</span>, <span class="refAuthor">Sakamoto, K.</span>, and <span class="refAuthor">T. Isobe</span>, <span class="refTitle">"MILP-based security evaluation for AEGIS/Tiaoxin-346/Rocca"</span>, <span class="refContent">IET Information Security, vol 17, 2023(3), pp. 458-467</span>, <span class="seriesInfo">DOI 10.1049/ise2.12109</span>, <time datetime="2023" class="refDate">2023</time>, <span>&lt;<a href="https://doi.org/10.1049/ise2.12109">https://doi.org/10.1049/ise2.12109</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TEST-VECTORS">[TEST-VECTORS]</dt>
        <dd>
<span class="refTitle">"AEGIS Test Vectors"</span>, <span class="refContent">commit 7e4a38d1</span>, <time datetime="2024" class="refDate">2024</time>, <span>&lt;<a href="https://github.com/cfrg/draft-irtf-cfrg-aegis-aead/tree/7e4a38d1/test-vectors">https://github.com/cfrg/draft-irtf-cfrg-aegis-aead/tree/7e4a38d1/test-vectors</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="VV18">[VV18]</dt>
      <dd>
<span class="refAuthor">Vaudenay, S.</span> and <span class="refAuthor">D. Vizár</span>, <span class="refTitle">"Can Caesar Beat Galois?"</span>, <span class="refContent">Applied Cryptography and Network Security. ACNS 2018. Lecture Notes in Computer Science, vol 10892, pp. 476–494</span>, <span class="seriesInfo">DOI 10.1007/978-3-319-93387-0_25</span>, <time datetime="2018" class="refDate">2018</time>, <span>&lt;<a href="https://doi.org/10.1007/978-3-319-93387-0_25">https://doi.org/10.1007/978-3-319-93387-0_25</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="test-vectors">
<section id="appendix-A">
      <h2 id="name-test-vectors">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-test-vectors" class="section-name selfRef">Test Vectors</a>
      </h2>
<p id="appendix-A-1">The following test vectors are also available in JSON format at <span>[<a href="#TEST-VECTORS" class="cite xref">TEST-VECTORS</a>]</span>. In this format, byte strings are represented as JSON strings containing their hexadecimal encoding.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div id="aesround-test-vector">
<section id="appendix-A.1">
        <h3 id="name-aesround-test-vector">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-aesround-test-vector" class="section-name selfRef">AESRound Test Vector</a>
        </h3>
<div class="lang-test-vectors sourcecode" id="appendix-A.1-1">
<pre>
in   : 000102030405060708090a0b0c0d0e0f

rk   : 101112131415161718191a1b1c1d1e1f

out  : 7a7b4e5638782546a8c0477a3b813f43
</pre><a href="#appendix-A.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="aegis-128l-test-vectors">
<section id="appendix-A.2">
        <h3 id="name-aegis-128l-test-vectors">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-aegis-128l-test-vectors" class="section-name selfRef">AEGIS-128L Test Vectors</a>
        </h3>
<div id="update-test-vector">
<section id="appendix-A.2.1">
          <h4 id="name-update-test-vector">
<a href="#appendix-A.2.1" class="section-number selfRef">A.2.1. </a><a href="#name-update-test-vector" class="section-name selfRef">Update Test Vector</a>
          </h4>
<div class="lang-test-vectors sourcecode" id="appendix-A.2.1-1">
<pre>
S0   : 9b7e60b24cc873ea894ecc07911049a3
S1   : 330be08f35300faa2ebf9a7b0d274658
S2   : 7bbd5bd2b049f7b9b515cf26fbe7756c
S3   : c35a00f55ea86c3886ec5e928f87db18
S4   : 9ebccafce87cab446396c4334592c91f
S5   : 58d83e31f256371e60fc6bb257114601
S6   : 1639b56ea322c88568a176585bc915de
S7   : 640818ffb57dc0fbc2e72ae93457e39a

M0   : 033e6975b94816879e42917650955aa0
M1   : fcc1968a46b7e97861bd6e89af6aa55f

After Update:
S0   : 596ab773e4433ca0127c73f60536769d
S1   : 790394041a3d26ab697bde865014652d
S2   : 38cf49e4b65248acd533041b64dd0611
S3   : 16d8e58748f437bfff1797f780337cee
S4   : 9689ecdf08228c74d7e3360cca53d0a5
S5   : a21746bb193a569e331e1aa985d0d729
S6   : 09d714e6fcf9177a8ed1cde7e3d259a6
S7   : 61279ba73167f0ab76f0a11bf203bdff
</pre><a href="#appendix-A.2.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-1">
<section id="appendix-A.2.2">
          <h4 id="name-test-vector-1">
<a href="#appendix-A.2.2" class="section-number selfRef">A.2.2. </a><a href="#name-test-vector-1" class="section-name selfRef">Test Vector 1</a>
          </h4>
<div class="lang-test-vectors sourcecode" id="appendix-A.2.2-1">
<pre>
key   : 10010000000000000000000000000000

nonce : 10000200000000000000000000000000

ad    :

msg   : 00000000000000000000000000000000

ct    : c1c0e58bd913006feba00f4b3cc3594e

tag128: abe0ece80c24868a226a35d16bdae37a

tag256: 25835bfbb21632176cf03840687cb968
        cace4617af1bd0f7d064c639a5c79ee4
</pre><a href="#appendix-A.2.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-2">
<section id="appendix-A.2.3">
          <h4 id="name-test-vector-2">
<a href="#appendix-A.2.3" class="section-number selfRef">A.2.3. </a><a href="#name-test-vector-2" class="section-name selfRef">Test Vector 2</a>
          </h4>
<div class="lang-test-vectors sourcecode" id="appendix-A.2.3-1">
<pre>
key   : 10010000000000000000000000000000

nonce : 10000200000000000000000000000000

ad    :

msg   :

ct    :

tag128: c2b879a67def9d74e6c14f708bbcc9b4

tag256: 1360dc9db8ae42455f6e5b6a9d488ea4
        f2184c4e12120249335c4ee84bafe25d
</pre><a href="#appendix-A.2.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-3">
<section id="appendix-A.2.4">
          <h4 id="name-test-vector-3">
<a href="#appendix-A.2.4" class="section-number selfRef">A.2.4. </a><a href="#name-test-vector-3" class="section-name selfRef">Test Vector 3</a>
          </h4>
<div class="lang-test-vectors sourcecode" id="appendix-A.2.4-1">
<pre>
key   : 10010000000000000000000000000000

nonce : 10000200000000000000000000000000

ad    : 0001020304050607

msg   : 000102030405060708090a0b0c0d0e0f
        101112131415161718191a1b1c1d1e1f

ct    : 79d94593d8c2119d7e8fd9b8fc77845c
        5c077a05b2528b6ac54b563aed8efe84

tag128: cc6f3372f6aa1bb82388d695c3962d9a

tag256: 022cb796fe7e0ae1197525ff67e30948
        4cfbab6528ddef89f17d74ef8ecd82b3
</pre><a href="#appendix-A.2.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-4">
<section id="appendix-A.2.5">
          <h4 id="name-test-vector-4">
<a href="#appendix-A.2.5" class="section-number selfRef">A.2.5. </a><a href="#name-test-vector-4" class="section-name selfRef">Test Vector 4</a>
          </h4>
<div class="lang-test-vectors sourcecode" id="appendix-A.2.5-1">
<pre>
key   : 10010000000000000000000000000000

nonce : 10000200000000000000000000000000

ad    : 0001020304050607

msg   : 000102030405060708090a0b0c0d

ct    : 79d94593d8c2119d7e8fd9b8fc77

tag128: 5c04b3dba849b2701effbe32c7f0fab7

tag256: 86f1b80bfb463aba711d15405d094baf
        4a55a15dbfec81a76f35ed0b9c8b04ac
</pre><a href="#appendix-A.2.5-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-5">
<section id="appendix-A.2.6">
          <h4 id="name-test-vector-5">
<a href="#appendix-A.2.6" class="section-number selfRef">A.2.6. </a><a href="#name-test-vector-5" class="section-name selfRef">Test Vector 5</a>
          </h4>
<div class="lang-test-vectors sourcecode" id="appendix-A.2.6-1">
<pre>
key   : 10010000000000000000000000000000

nonce : 10000200000000000000000000000000

ad    : 000102030405060708090a0b0c0d0e0f
        101112131415161718191a1b1c1d1e1f
        20212223242526272829

msg   : 101112131415161718191a1b1c1d1e1f
        202122232425262728292a2b2c2d2e2f
        3031323334353637

ct    : b31052ad1cca4e291abcf2df3502e6bd
        b1bfd6db36798be3607b1f94d34478aa
        7ede7f7a990fec10

tag128: 7542a745733014f9474417b337399507

tag256: b91e2947a33da8bee89b6794e647baf0
        fc835ff574aca3fc27c33be0db2aff98
</pre><a href="#appendix-A.2.6-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-6">
<section id="appendix-A.2.7">
          <h4 id="name-test-vector-6">
<a href="#appendix-A.2.7" class="section-number selfRef">A.2.7. </a><a href="#name-test-vector-6" class="section-name selfRef">Test Vector 6</a>
          </h4>
<p id="appendix-A.2.7-1">This test <span class="bcp14">MUST</span> return a “verification failed” error.<a href="#appendix-A.2.7-1" class="pilcrow">¶</a></p>
<div class="lang-test-vectors sourcecode" id="appendix-A.2.7-2">
<pre>
key   : 10000200000000000000000000000000

nonce : 10010000000000000000000000000000

ad    : 0001020304050607

ct    : 79d94593d8c2119d7e8fd9b8fc77

tag128: 5c04b3dba849b2701effbe32c7f0fab7

tag256: 86f1b80bfb463aba711d15405d094baf
        4a55a15dbfec81a76f35ed0b9c8b04ac
</pre><a href="#appendix-A.2.7-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-7">
<section id="appendix-A.2.8">
          <h4 id="name-test-vector-7">
<a href="#appendix-A.2.8" class="section-number selfRef">A.2.8. </a><a href="#name-test-vector-7" class="section-name selfRef">Test Vector 7</a>
          </h4>
<p id="appendix-A.2.8-1">This test <span class="bcp14">MUST</span> return a “verification failed” error.<a href="#appendix-A.2.8-1" class="pilcrow">¶</a></p>
<div class="lang-test-vectors sourcecode" id="appendix-A.2.8-2">
<pre>
key   : 10010000000000000000000000000000

nonce : 10000200000000000000000000000000

ad    : 0001020304050607

ct    : 79d94593d8c2119d7e8fd9b8fc78

tag128: 5c04b3dba849b2701effbe32c7f0fab7

tag256: 86f1b80bfb463aba711d15405d094baf
        4a55a15dbfec81a76f35ed0b9c8b04ac
</pre><a href="#appendix-A.2.8-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-8">
<section id="appendix-A.2.9">
          <h4 id="name-test-vector-8">
<a href="#appendix-A.2.9" class="section-number selfRef">A.2.9. </a><a href="#name-test-vector-8" class="section-name selfRef">Test Vector 8</a>
          </h4>
<p id="appendix-A.2.9-1">This test <span class="bcp14">MUST</span> return a “verification failed” error.<a href="#appendix-A.2.9-1" class="pilcrow">¶</a></p>
<div class="lang-test-vectors sourcecode" id="appendix-A.2.9-2">
<pre>
key   : 10010000000000000000000000000000

nonce : 10000200000000000000000000000000

ad    : 0001020304050608

ct    : 79d94593d8c2119d7e8fd9b8fc77

tag128: 5c04b3dba849b2701effbe32c7f0fab7

tag256: 86f1b80bfb463aba711d15405d094baf
        4a55a15dbfec81a76f35ed0b9c8b04ac
</pre><a href="#appendix-A.2.9-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-9">
<section id="appendix-A.2.10">
          <h4 id="name-test-vector-9">
<a href="#appendix-A.2.10" class="section-number selfRef">A.2.10. </a><a href="#name-test-vector-9" class="section-name selfRef">Test Vector 9</a>
          </h4>
<p id="appendix-A.2.10-1">This test <span class="bcp14">MUST</span> return a “verification failed” error.<a href="#appendix-A.2.10-1" class="pilcrow">¶</a></p>
<div class="lang-test-vectors sourcecode" id="appendix-A.2.10-2">
<pre>
key   : 10010000000000000000000000000000

nonce : 10000200000000000000000000000000

ad    : 0001020304050607

ct    : 79d94593d8c2119d7e8fd9b8fc77

tag128: 6c04b3dba849b2701effbe32c7f0fab8

tag256: 86f1b80bfb463aba711d15405d094baf
        4a55a15dbfec81a76f35ed0b9c8b04ad
</pre><a href="#appendix-A.2.10-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="aegis-256-test-vectors">
<section id="appendix-A.3">
        <h3 id="name-aegis-256-test-vectors">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-aegis-256-test-vectors" class="section-name selfRef">AEGIS-256 Test Vectors</a>
        </h3>
<div id="update-test-vector-1">
<section id="appendix-A.3.1">
          <h4 id="name-update-test-vector-2">
<a href="#appendix-A.3.1" class="section-number selfRef">A.3.1. </a><a href="#name-update-test-vector-2" class="section-name selfRef">Update Test Vector</a>
          </h4>
<div class="lang-test-vectors sourcecode" id="appendix-A.3.1-1">
<pre>
S0   : 1fa1207ed76c86f2c4bb40e8b395b43e
S1   : b44c375e6c1e1978db64bcd12e9e332f
S2   : 0dab84bfa9f0226432ff630f233d4e5b
S3   : d7ef65c9b93e8ee60c75161407b066e7
S4   : a760bb3da073fbd92bdc24734b1f56fb
S5   : a828a18d6a964497ac6e7e53c5f55c73

M    : b165617ed04ab738afb2612c6d18a1ec

After Update:
S0   : e6bc643bae82dfa3d991b1b323839dcd
S1   : 648578232ba0f2f0a3677f617dc052c3
S2   : ea788e0e572044a46059212dd007a789
S3   : 2f1498ae19b80da13fba698f088a8590
S4   : a54c2ee95e8c2a2c3dae2ec743ae6b86
S5   : a3240fceb68e32d5d114df1b5363ab67
</pre><a href="#appendix-A.3.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-1-1">
<section id="appendix-A.3.2">
          <h4 id="name-test-vector-1-2">
<a href="#appendix-A.3.2" class="section-number selfRef">A.3.2. </a><a href="#name-test-vector-1-2" class="section-name selfRef">Test Vector 1</a>
          </h4>
<div class="lang-test-vectors sourcecode" id="appendix-A.3.2-1">
<pre>
key   : 10010000000000000000000000000000
        00000000000000000000000000000000

nonce : 10000200000000000000000000000000
        00000000000000000000000000000000

ad    :

msg   : 00000000000000000000000000000000

ct    : 754fc3d8c973246dcc6d741412a4b236

tag128: 3fe91994768b332ed7f570a19ec5896e

tag256: 1181a1d18091082bf0266f66297d167d
        2e68b845f61a3b0527d31fc7b7b89f13
</pre><a href="#appendix-A.3.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-2-1">
<section id="appendix-A.3.3">
          <h4 id="name-test-vector-2-2">
<a href="#appendix-A.3.3" class="section-number selfRef">A.3.3. </a><a href="#name-test-vector-2-2" class="section-name selfRef">Test Vector 2</a>
          </h4>
<div class="lang-test-vectors sourcecode" id="appendix-A.3.3-1">
<pre>
key   : 10010000000000000000000000000000
        00000000000000000000000000000000

nonce : 10000200000000000000000000000000
        00000000000000000000000000000000

ad    :

msg   :

ct    :

tag128: e3def978a0f054afd1e761d7553afba3

tag256: 6a348c930adbd654896e1666aad67de9
        89ea75ebaa2b82fb588977b1ffec864a
</pre><a href="#appendix-A.3.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-3-1">
<section id="appendix-A.3.4">
          <h4 id="name-test-vector-3-2">
<a href="#appendix-A.3.4" class="section-number selfRef">A.3.4. </a><a href="#name-test-vector-3-2" class="section-name selfRef">Test Vector 3</a>
          </h4>
<div class="lang-test-vectors sourcecode" id="appendix-A.3.4-1">
<pre>
key   : 10010000000000000000000000000000
        00000000000000000000000000000000

nonce : 10000200000000000000000000000000
        00000000000000000000000000000000

ad    : 0001020304050607

msg   : 000102030405060708090a0b0c0d0e0f
        101112131415161718191a1b1c1d1e1f

ct    : f373079ed84b2709faee373584585d60
        accd191db310ef5d8b11833df9dec711

tag128: 8d86f91ee606e9ff26a01b64ccbdd91d

tag256: b7d28d0c3c0ebd409fd22b4416050307
        3a547412da0854bfb9723020dab8da1a
</pre><a href="#appendix-A.3.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-4-1">
<section id="appendix-A.3.5">
          <h4 id="name-test-vector-4-2">
<a href="#appendix-A.3.5" class="section-number selfRef">A.3.5. </a><a href="#name-test-vector-4-2" class="section-name selfRef">Test Vector 4</a>
          </h4>
<div class="lang-test-vectors sourcecode" id="appendix-A.3.5-1">
<pre>
key   : 10010000000000000000000000000000
        00000000000000000000000000000000

nonce : 10000200000000000000000000000000
        00000000000000000000000000000000

ad    : 0001020304050607

msg   : 000102030405060708090a0b0c0d

ct    : f373079ed84b2709faee37358458

tag128: c60b9c2d33ceb058f96e6dd03c215652

tag256: 8c1cc703c81281bee3f6d9966e14948b
        4a175b2efbdc31e61a98b4465235c2d9
</pre><a href="#appendix-A.3.5-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-5-1">
<section id="appendix-A.3.6">
          <h4 id="name-test-vector-5-2">
<a href="#appendix-A.3.6" class="section-number selfRef">A.3.6. </a><a href="#name-test-vector-5-2" class="section-name selfRef">Test Vector 5</a>
          </h4>
<div class="lang-test-vectors sourcecode" id="appendix-A.3.6-1">
<pre>
key   : 10010000000000000000000000000000
        00000000000000000000000000000000

nonce : 10000200000000000000000000000000
        00000000000000000000000000000000

ad    : 000102030405060708090a0b0c0d0e0f
        101112131415161718191a1b1c1d1e1f
        20212223242526272829

msg   : 101112131415161718191a1b1c1d1e1f
        202122232425262728292a2b2c2d2e2f
        3031323334353637

ct    : 57754a7d09963e7c787583a2e7b859bb
        24fa1e04d49fd550b2511a358e3bca25
        2a9b1b8b30cc4a67

tag128: ab8a7d53fd0e98d727accca94925e128

tag256: a3aca270c006094d71c20e6910b5161c
        0826df233d08919a566ec2c05990f734
</pre><a href="#appendix-A.3.6-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-6-1">
<section id="appendix-A.3.7">
          <h4 id="name-test-vector-6-2">
<a href="#appendix-A.3.7" class="section-number selfRef">A.3.7. </a><a href="#name-test-vector-6-2" class="section-name selfRef">Test Vector 6</a>
          </h4>
<p id="appendix-A.3.7-1">This test <span class="bcp14">MUST</span> return a “verification failed” error.<a href="#appendix-A.3.7-1" class="pilcrow">¶</a></p>
<div class="lang-test-vectors sourcecode" id="appendix-A.3.7-2">
<pre>
key   : 10000200000000000000000000000000
        00000000000000000000000000000000

nonce : 10010000000000000000000000000000
        00000000000000000000000000000000

ad    : 0001020304050607

ct    : f373079ed84b2709faee37358458

tag128: c60b9c2d33ceb058f96e6dd03c215652

tag256: 8c1cc703c81281bee3f6d9966e14948b
        4a175b2efbdc31e61a98b4465235c2d9
</pre><a href="#appendix-A.3.7-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-7-1">
<section id="appendix-A.3.8">
          <h4 id="name-test-vector-7-2">
<a href="#appendix-A.3.8" class="section-number selfRef">A.3.8. </a><a href="#name-test-vector-7-2" class="section-name selfRef">Test Vector 7</a>
          </h4>
<p id="appendix-A.3.8-1">This test <span class="bcp14">MUST</span> return a “verification failed” error.<a href="#appendix-A.3.8-1" class="pilcrow">¶</a></p>
<div class="lang-test-vectors sourcecode" id="appendix-A.3.8-2">
<pre>
key   : 10010000000000000000000000000000
        00000000000000000000000000000000

nonce : 10000200000000000000000000000000
        00000000000000000000000000000000

ad    : 0001020304050607

ct    : f373079ed84b2709faee37358459

tag128: c60b9c2d33ceb058f96e6dd03c215652

tag256: 8c1cc703c81281bee3f6d9966e14948b
        4a175b2efbdc31e61a98b4465235c2d9
</pre><a href="#appendix-A.3.8-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-8-1">
<section id="appendix-A.3.9">
          <h4 id="name-test-vector-8-2">
<a href="#appendix-A.3.9" class="section-number selfRef">A.3.9. </a><a href="#name-test-vector-8-2" class="section-name selfRef">Test Vector 8</a>
          </h4>
<p id="appendix-A.3.9-1">This test <span class="bcp14">MUST</span> return a “verification failed” error.<a href="#appendix-A.3.9-1" class="pilcrow">¶</a></p>
<div class="lang-test-vectors sourcecode" id="appendix-A.3.9-2">
<pre>
key   : 10010000000000000000000000000000
        00000000000000000000000000000000

nonce : 10000200000000000000000000000000
        00000000000000000000000000000000

ad    : 0001020304050608

ct    : f373079ed84b2709faee37358458

tag128: c60b9c2d33ceb058f96e6dd03c215652

tag256: 8c1cc703c81281bee3f6d9966e14948b
        4a175b2efbdc31e61a98b4465235c2d9
</pre><a href="#appendix-A.3.9-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-9-1">
<section id="appendix-A.3.10">
          <h4 id="name-test-vector-9-2">
<a href="#appendix-A.3.10" class="section-number selfRef">A.3.10. </a><a href="#name-test-vector-9-2" class="section-name selfRef">Test Vector 9</a>
          </h4>
<p id="appendix-A.3.10-1">This test <span class="bcp14">MUST</span> return a “verification failed” error.<a href="#appendix-A.3.10-1" class="pilcrow">¶</a></p>
<div class="lang-test-vectors sourcecode" id="appendix-A.3.10-2">
<pre>
key   : 10010000000000000000000000000000
        00000000000000000000000000000000

nonce : 10000200000000000000000000000000
        00000000000000000000000000000000

ad    : 0001020304050607

ct    : f373079ed84b2709faee37358458

tag128: c60b9c2d33ceb058f96e6dd03c215653

tag256: 8c1cc703c81281bee3f6d9966e14948b
        4a175b2efbdc31e61a98b4465235c2da
</pre><a href="#appendix-A.3.10-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="aegis-128x2-test-vectors">
<section id="appendix-A.4">
        <h3 id="name-aegis-128x2-test-vectors">
<a href="#appendix-A.4" class="section-number selfRef">A.4. </a><a href="#name-aegis-128x2-test-vectors" class="section-name selfRef">AEGIS-128X2 Test Vectors</a>
        </h3>
<div id="initial-state">
<section id="appendix-A.4.1">
          <h4 id="name-initial-state">
<a href="#appendix-A.4.1" class="section-number selfRef">A.4.1. </a><a href="#name-initial-state" class="section-name selfRef">Initial State</a>
          </h4>
<div class="lang-test-vectors sourcecode" id="appendix-A.4.1-1">
<pre>
key   : 000102030405060708090a0b0c0d0e0f

nonce : 101112131415161718191a1b1c1d1e1f

ctx[0]: 00010000000000000000000000000000
ctx[1]: 01010000000000000000000000000000
</pre><a href="#appendix-A.4.1-1" class="pilcrow">¶</a>
</div>
<p id="appendix-A.4.1-2">After initialization:<a href="#appendix-A.4.1-2" class="pilcrow">¶</a></p>
<div class="lang-test-vectors sourcecode" id="appendix-A.4.1-3">
<pre>
V[0,0]: a4fc1ad9a72942fb88bd2cabbba6509a
V[0,1]: 80a40e392fc71084209b6c3319bdc6cc

V[1,0]: 380f435cf801763b1f0c2a2f7212052d
V[1,1]: 73796607b59b1b650ee91c152af1f18a

V[2,0]: 6ee1de433ea877fa33bc0782abff2dcb
V[2,1]: b9fab2ab496e16d1facaffd5453cbf14

V[3,0]: 85f94b0d4263bfa86fdf45a603d8b6ac
V[3,1]: 90356c8cadbaa2c969001da02e3feca0

V[4,0]: 09bd69ad3730174bcd2ce9a27cd1357e
V[4,1]: e610b45125796a4fcf1708cef5c4f718

V[5,0]: fcdeb0cf0a87bf442fc82383ddb0f6d6
V[5,1]: 61ad32a4694d6f3cca313a2d3f4687aa

V[6,0]: 571c207988659e2cdfbdaae77f4f37e3
V[6,1]: 32e6094e217573bf91fb28c145a3efa8

V[7,0]: ca549badf8faa58222412478598651cf
V[7,1]: 3407279a54ce76d2e2e8a90ec5d108eb
</pre><a href="#appendix-A.4.1-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-1-2">
<section id="appendix-A.4.2">
          <h4 id="name-test-vector-1-3">
<a href="#appendix-A.4.2" class="section-number selfRef">A.4.2. </a><a href="#name-test-vector-1-3" class="section-name selfRef">Test Vector 1</a>
          </h4>
<div class="lang-test-vectors sourcecode" id="appendix-A.4.2-1">
<pre>
key   : 000102030405060708090a0b0c0d0e0f

nonce : 101112131415161718191a1b1c1d1e1f

ad    :

msg   :

ct    :

tag128: 63117dc57756e402819a82e13eca8379

tag256: b92c71fdbd358b8a4de70b27631ace90
        cffd9b9cfba82028412bac41b4f53759
</pre><a href="#appendix-A.4.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-2-2">
<section id="appendix-A.4.3">
          <h4 id="name-test-vector-2-3">
<a href="#appendix-A.4.3" class="section-number selfRef">A.4.3. </a><a href="#name-test-vector-2-3" class="section-name selfRef">Test Vector 2</a>
          </h4>
<div class="lang-test-vectors sourcecode" id="appendix-A.4.3-1">
<pre>
key   : 000102030405060708090a0b0c0d0e0f

nonce : 101112131415161718191a1b1c1d1e1f

ad    : 0102030401020304

msg   : 04050607040506070405060704050607
        04050607040506070405060704050607
        04050607040506070405060704050607
        04050607040506070405060704050607
        04050607040506070405060704050607
        04050607040506070405060704050607
        04050607040506070405060704050607
        0405060704050607

ct    : 5795544301997f93621b278809d6331b
        3bfa6f18e90db12c4aa35965b5e98c5f
        c6fb4e54bcb6111842c20637252eff74
        7cb3a8f85b37de80919a589fe0f24872
        bc926360696739e05520647e390989e1
        eb5fd42f99678a0276a498f8c454761c
        9d6aacb647ad56be62b29c22cd4b5761
        b38f43d5a5ee062f

tag128: 1aebc200804f405cab637f2adebb6d77

tag256: c471876f9b4978c44f2ae1ce770cdb11
        a094ee3feca64e7afcd48bfe52c60eca
</pre><a href="#appendix-A.4.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="aegis-128x4-test-vectors">
<section id="appendix-A.5">
        <h3 id="name-aegis-128x4-test-vectors">
<a href="#appendix-A.5" class="section-number selfRef">A.5. </a><a href="#name-aegis-128x4-test-vectors" class="section-name selfRef">AEGIS-128X4 Test Vectors</a>
        </h3>
<div id="initial-state-1">
<section id="appendix-A.5.1">
          <h4 id="name-initial-state-2">
<a href="#appendix-A.5.1" class="section-number selfRef">A.5.1. </a><a href="#name-initial-state-2" class="section-name selfRef">Initial State</a>
          </h4>
<div class="lang-test-vectors sourcecode" id="appendix-A.5.1-1">
<pre>
key   : 000102030405060708090a0b0c0d0e0f

nonce : 101112131415161718191a1b1c1d1e1f

ctx[0]: 00030000000000000000000000000000
ctx[1]: 01030000000000000000000000000000
ctx[2]: 02030000000000000000000000000000
ctx[3]: 03030000000000000000000000000000
</pre><a href="#appendix-A.5.1-1" class="pilcrow">¶</a>
</div>
<p id="appendix-A.5.1-2">After initialization:<a href="#appendix-A.5.1-2" class="pilcrow">¶</a></p>
<div class="lang-test-vectors sourcecode" id="appendix-A.5.1-3">
<pre>
V[0,0]: 924eb07635003a37e6c6575ba8ce1929
V[0,1]: c8b6a5d91475445e936d48e794be0ce2
V[0,2]: fcd37d050e24084befe3bbb219d64760
V[0,3]: 2e9f58cfb893a8800220242c373a8b18

V[1,0]: 1a1f60c4fab64e5471dc72edfcf6fe6b
V[1,1]: c1e525ebea2d6375a9edd045dce96381
V[1,2]: 97a3e25abd228a44d4a14a6d3fe9185c
V[1,3]: c2d4cf7f4287a98744645674265d4ca8

V[2,0]: 7bb50c534f6ec4780530ff1cce8a16e8
V[2,1]: 7b08d57557da0b5ef7b5f7d98b0ba189
V[2,2]: 6bfcac34ddb68404821a4d665303cb0f
V[2,3]: d95626f6dfad1aed7467622c38529932

V[3,0]: af339fd2d50ee45fc47665c647cf6586
V[3,1]: d0669b39d140f0e118a4a511efe2f95a
V[3,2]: 7a94330f35c194fadda2a87e42cdeccc
V[3,3]: 233b640d1f4d56e2757e72c1a9d8ecb1

V[4,0]: 9f93737d699ba05c11e94f2b201bef5e
V[4,1]: 61caf387cf7cfd3f8300ac7680ccfd76
V[4,2]: 5825a671ecef03b7a9c98a601ae32115
V[4,3]: 87a1fe4d558161a8f4c38731f3223032

V[5,0]: 7a5aca78d636c05bbc702b2980196ab6
V[5,1]: 915d868408495d07eb527789f282c575
V[5,2]: d0947bfbc1d3309cdffc9be1503aea62
V[5,3]: 8834ea57a15b9fbdc0245464a4b8cbef

V[6,0]: e46f4cf71a95ac45b6f0823e3aba1a86
V[6,1]: 8c4ecef682fc44a8eba911b3fc7d99f9
V[6,2]: a4fb61e2c928a2ca760b8772f2ea5f2e
V[6,3]: 3d34ea89da73caa3016c280500a155a3

V[7,0]: 85075f0080e9d618e7eb40f57c32d9f7
V[7,1]: d2ab2b320c6e93b155a3787cb83e5281
V[7,2]: 0b3af0250ae36831a1b072e499929bcb
V[7,3]: 5cce4d00329d69f1aae36aa541347512
</pre><a href="#appendix-A.5.1-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-1-3">
<section id="appendix-A.5.2">
          <h4 id="name-test-vector-1-4">
<a href="#appendix-A.5.2" class="section-number selfRef">A.5.2. </a><a href="#name-test-vector-1-4" class="section-name selfRef">Test Vector 1</a>
          </h4>
<div class="lang-test-vectors sourcecode" id="appendix-A.5.2-1">
<pre>
key   : 000102030405060708090a0b0c0d0e0f

nonce : 101112131415161718191a1b1c1d1e1f

ad    :

msg   :

ct    :

tag128: 5bef762d0947c00455b97bb3af30dfa3

tag256: a4b25437f4be93cfa856a2f27e4416b4
        2cac79fd4698f2cdbe6af25673e10a68
</pre><a href="#appendix-A.5.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-2-3">
<section id="appendix-A.5.3">
          <h4 id="name-test-vector-2-4">
<a href="#appendix-A.5.3" class="section-number selfRef">A.5.3. </a><a href="#name-test-vector-2-4" class="section-name selfRef">Test Vector 2</a>
          </h4>
<div class="lang-test-vectors sourcecode" id="appendix-A.5.3-1">
<pre>
key   : 000102030405060708090a0b0c0d0e0f

nonce : 101112131415161718191a1b1c1d1e1f

ad    : 0102030401020304

msg   : 04050607040506070405060704050607
        04050607040506070405060704050607
        04050607040506070405060704050607
        04050607040506070405060704050607
        04050607040506070405060704050607
        04050607040506070405060704050607
        04050607040506070405060704050607
        0405060704050607

ct    : e836118562f4479c9d35c17356a83311
        4c21f9aa39e4dda5e5c87f4152a00fce
        9a7c38f832eafe8b1c12f8a7cf12a81a
        1ad8a9c24ba9dedfbdaa586ffea67ddc
        801ea97d9ab4a872f42d0e352e2713da
        cd609f9442c17517c5a29daf3e2a3fac
        4ff6b1380c4e46df7b086af6ce6bc1ed
        594b8dd64aed2a7e

tag128: 0e56ab94e2e85db80f9d54010caabfb4

tag256: 69abf0f64a137dd6e122478d777e98bc
        422823006cf57f5ee822dd78397230b2
</pre><a href="#appendix-A.5.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="aegis-256x2-test-vectors">
<section id="appendix-A.6">
        <h3 id="name-aegis-256x2-test-vectors">
<a href="#appendix-A.6" class="section-number selfRef">A.6. </a><a href="#name-aegis-256x2-test-vectors" class="section-name selfRef">AEGIS-256X2 Test Vectors</a>
        </h3>
<div id="initial-state-2">
<section id="appendix-A.6.1">
          <h4 id="name-initial-state-3">
<a href="#appendix-A.6.1" class="section-number selfRef">A.6.1. </a><a href="#name-initial-state-3" class="section-name selfRef">Initial State</a>
          </h4>
<div class="lang-test-vectors sourcecode" id="appendix-A.6.1-1">
<pre>
key   : 000102030405060708090a0b0c0d0e0f
        101112131415161718191a1b1c1d1e1f

nonce : 101112131415161718191a1b1c1d1e1f
        202122232425262728292a2b2c2d2e2f

ctx[0]: 00010000000000000000000000000000
ctx[1]: 01010000000000000000000000000000
</pre><a href="#appendix-A.6.1-1" class="pilcrow">¶</a>
</div>
<p id="appendix-A.6.1-2">After initialization:<a href="#appendix-A.6.1-2" class="pilcrow">¶</a></p>
<div class="lang-test-vectors sourcecode" id="appendix-A.6.1-3">
<pre>
V[0,0]: eca2bf4538442e8712d4972595744039
V[0,1]: 201405efa9264f07911db58101903087

V[1,0]: 3e536a998799408a97f3479a6f779d48
V[1,1]: 0d79a7d822a5d215f78c3bf2feb33ae1

V[2,0]: cf8c63d6f2b4563cdd9231107c85950e
V[2,1]: 78d17ed7d8d563ff11bd202c76864839

V[3,0]: d7e0707e6bfbbad913bc94b6993a9fa0
V[3,1]: 097e4b1bff40d4c19cb29dfd125d62f2

V[4,0]: a373cf6d537dd66bc0ef0f2f9285359f
V[4,1]: c0d0ae0c48f9df3faaf0e7be7768c326

V[5,0]: 9f76560dcae1efacabdcce446ae283bc
V[5,1]: bd52a6b9c8f976a26ec1409df19e8bfe
</pre><a href="#appendix-A.6.1-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-1-4">
<section id="appendix-A.6.2">
          <h4 id="name-test-vector-1-5">
<a href="#appendix-A.6.2" class="section-number selfRef">A.6.2. </a><a href="#name-test-vector-1-5" class="section-name selfRef">Test Vector 1</a>
          </h4>
<div class="lang-test-vectors sourcecode" id="appendix-A.6.2-1">
<pre>
key   : 000102030405060708090a0b0c0d0e0f
        101112131415161718191a1b1c1d1e1f

nonce : 101112131415161718191a1b1c1d1e1f
        202122232425262728292a2b2c2d2e2f

ad    :

msg   :

ct    :

tag128: 62cdbab084c83dacdb945bb446f049c8

tag256: 25d7e799b49a80354c3f881ac2f1027f
        471a5d293052bd9997abd3ae84014bb7
</pre><a href="#appendix-A.6.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-2-4">
<section id="appendix-A.6.3">
          <h4 id="name-test-vector-2-5">
<a href="#appendix-A.6.3" class="section-number selfRef">A.6.3. </a><a href="#name-test-vector-2-5" class="section-name selfRef">Test Vector 2</a>
          </h4>
<div class="lang-test-vectors sourcecode" id="appendix-A.6.3-1">
<pre>
key   : 000102030405060708090a0b0c0d0e0f
        101112131415161718191a1b1c1d1e1f

nonce : 101112131415161718191a1b1c1d1e1f
        202122232425262728292a2b2c2d2e2f

ad    : 0102030401020304

msg   : 04050607040506070405060704050607
        04050607040506070405060704050607
        04050607040506070405060704050607
        04050607040506070405060704050607
        04050607040506070405060704050607
        04050607040506070405060704050607
        04050607040506070405060704050607
        0405060704050607

ct    : 73110d21a920608fd77b580f1e442808
        7a7365cb153b4eeca6b62e1a70f7f9a8
        d1f31f17da4c3acfacb2517f2f5e1575
        8c35532e33751a964d18d29a599d2dc0
        7f9378339b9d8c9fa03d30a4d7837cc8
        eb8b99bcbba2d11cd1a0f994af2b8f94
        7ef18473bd519e5283736758480abc99
        0e79d4ccab93dde9

tag128: 94a3bd44ad3381e36335014620ee638e

tag256: 0392c62b17ddb00c172a010b5a327d0f
        97317b6fbaee31ef741f004d7adc1e81
</pre><a href="#appendix-A.6.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="aegis-256x4-test-vectors">
<section id="appendix-A.7">
        <h3 id="name-aegis-256x4-test-vectors">
<a href="#appendix-A.7" class="section-number selfRef">A.7. </a><a href="#name-aegis-256x4-test-vectors" class="section-name selfRef">AEGIS-256X4 Test Vectors</a>
        </h3>
<div id="initial-state-3">
<section id="appendix-A.7.1">
          <h4 id="name-initial-state-4">
<a href="#appendix-A.7.1" class="section-number selfRef">A.7.1. </a><a href="#name-initial-state-4" class="section-name selfRef">Initial State</a>
          </h4>
<div class="lang-test-vectors sourcecode" id="appendix-A.7.1-1">
<pre>
key   : 000102030405060708090a0b0c0d0e0f
        101112131415161718191a1b1c1d1e1f

nonce : 101112131415161718191a1b1c1d1e1f
        202122232425262728292a2b2c2d2e2f

ctx[0]: 00030000000000000000000000000000
ctx[1]: 01030000000000000000000000000000
ctx[2]: 02030000000000000000000000000000
ctx[3]: 03030000000000000000000000000000
</pre><a href="#appendix-A.7.1-1" class="pilcrow">¶</a>
</div>
<p id="appendix-A.7.1-2">After initialization:<a href="#appendix-A.7.1-2" class="pilcrow">¶</a></p>
<div class="lang-test-vectors sourcecode" id="appendix-A.7.1-3">
<pre>
V[0,0]: 482a86e8436cd2361063a4b2702769b9
V[0,1]: d95a2be81c9245b22996f68eea0122f9
V[0,2]: 0c2a3b348b1a5e256c6751377318c41e
V[0,3]: f64436a21653fe7cf2e0829a177db383

V[1,0]: e705e8866267717d96092e58e78b574c
V[1,1]: d1dd412142df9806cc267af2fe1d830e
V[1,2]: 30e7dfd3c9941b8394e95bdf5bac99d9
V[1,3]: 9f27186f8a4fab86820689822c3c74d2

V[2,0]: e1aa6af5d9e31dde8d94a48a0810fa89
V[2,1]: 63555cdf0d98f18fb75b029ad80786c0
V[2,2]: a3ee0e4a3429a9539e4fcec385475608
V[2,3]: 28ea527d31ef61df498dc107fe02df99

V[3,0]: 37f06808410c8f3954525ae44584d3be
V[3,1]: 8fcc23bca2fe2209f93d34e2da35b33d
V[3,2]: 33156347df89eaa69ab11096362daccf
V[3,3]: bbe58d9dbe8c5b0469be5a87086db5d4

V[4,0]: d1c9eb37fecbc5ada7b351fa4f501f32
V[4,1]: 0b9b803283c1538628b507c8f6432434
V[4,2]: bfb8b6d4f87cce28825c7e92f54b8728
V[4,3]: 8917bb5b09c32f900c6a5a1d63c46264

V[5,0]: 4f6110c2ef0c3c687e90c1e5532ddf8e
V[5,1]: 031bd85d99f64684d23728a0453c72a1
V[5,2]: 10bc7ec34d4119b5bdeb6c7dfc458247
V[5,3]: 591ece530aeaa5c9867220156f5c25e3
</pre><a href="#appendix-A.7.1-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-1-5">
<section id="appendix-A.7.2">
          <h4 id="name-test-vector-1-6">
<a href="#appendix-A.7.2" class="section-number selfRef">A.7.2. </a><a href="#name-test-vector-1-6" class="section-name selfRef">Test Vector 1</a>
          </h4>
<div class="lang-test-vectors sourcecode" id="appendix-A.7.2-1">
<pre>
key   : 000102030405060708090a0b0c0d0e0f
        101112131415161718191a1b1c1d1e1f

nonce : 101112131415161718191a1b1c1d1e1f
        202122232425262728292a2b2c2d2e2f

ad    :

msg   :

ct    :

tag128: 3b7fee6cee7bf17888ad11ed2397beb4

tag256: 6093a1a8aab20ec635dc1ca71745b01b
        5bec4fc444c9ffbebd710d4a34d20eaf
</pre><a href="#appendix-A.7.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-2-5">
<section id="appendix-A.7.3">
          <h4 id="name-test-vector-2-6">
<a href="#appendix-A.7.3" class="section-number selfRef">A.7.3. </a><a href="#name-test-vector-2-6" class="section-name selfRef">Test Vector 2</a>
          </h4>
<div class="lang-test-vectors sourcecode" id="appendix-A.7.3-1">
<pre>
key   : 000102030405060708090a0b0c0d0e0f
        101112131415161718191a1b1c1d1e1f

nonce : 101112131415161718191a1b1c1d1e1f
        202122232425262728292a2b2c2d2e2f

ad    : 0102030401020304

msg   : 04050607040506070405060704050607
        04050607040506070405060704050607
        04050607040506070405060704050607
        04050607040506070405060704050607
        04050607040506070405060704050607
        04050607040506070405060704050607
        04050607040506070405060704050607
        0405060704050607

ct    : bec109547f8316d598b3b7d947ad4c0e
        f5b98e217cffa0d858ad49ae34109a95
        abc5b5fada820c4d6ae2fca0f5e2444e
        52a04a1edb7bec71408de3e199500521
        94506be3ba6a4de51a15a577ea0e4c14
        f7539a13e751a555f48d0f49fecffb22
        0525e60d381e2efa803b09b7164ba59f
        dc66656affd51e06

tag128: ec44b512d713f745547be345bcc66b6c

tag256: ba3168ecd7f7120c5e204a7e0d616e39
        5675ddfe00e4e5490a5ba93bb1a70555
</pre><a href="#appendix-A.7.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-B">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-B-1">The AEGIS authenticated encryption algorithm was invented by Hongjun Wu and Bart Preneel.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">The state update function leverages the AES permutation invented by Joan Daemen and Vincent Rijmen. They also authored the Pelican MAC, which partly motivated the design of the AEGIS MAC.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<p id="appendix-B-3">We would like to thank the following individuals for their contributions:<a href="#appendix-B-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-4.1">
          <p id="appendix-B-4.1.1">Eric Lagergren and Daniel Bleichenbacher for catching a broken test vector and Daniel Bleichenbacher for many helpful suggestions.<a href="#appendix-B-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-4.2">
          <p id="appendix-B-4.2.1">John Preuß Mattsson for his review of the draft, and for suggesting how AEGIS should be used in the context of DTLS and QUIC.<a href="#appendix-B-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-4.3">
          <p id="appendix-B-4.3.1">Bart Mennink and Charlotte Lefevre as well as Takanori Isobe and Mostafizar Rahman for investigating the commitment security of the schemes specified in this document.<a href="#appendix-B-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-4.4">
          <p id="appendix-B-4.4.1">Scott Fluhrer for his review of the draft as a member of the CFRG Crypto Panel.<a href="#appendix-B-4.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-4.5">
          <p id="appendix-B-4.5.1">Yawning Angel, Chris Barber, and Neil Madden for their review of the draft.<a href="#appendix-B-4.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-4.6">
          <p id="appendix-B-4.6.1">Gilles Van Assche for reviewing the draft and providing insightful comments on the implications of nonce reuse in AEGIS-128X and AEGIS-256X.<a href="#appendix-B-4.6.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Frank Denis</span></div>
<div dir="auto" class="left"><span class="org">Fastly Inc.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:fde@00f.net" class="email">fde@00f.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Samuel Lucas</span></div>
<div dir="auto" class="left"><span class="org">Individual Contributor</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:samuel-lucas6@pm.me" class="email">samuel-lucas6@pm.me</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
